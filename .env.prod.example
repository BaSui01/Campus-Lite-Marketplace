# 校园轻享集市系统 - 生产环境配置模板
# 使用说明：复制为 .env 并按生产环境真实值填写；或在部署编排中以环境变量覆盖

# ==================== 应用配置 ====================
APP_NAME=campus-marketplace
SPRING_PROFILES_ACTIVE=prod
SERVER_PORT=8080
APP_CONTEXT_PATH=/api

# ==================== PostgreSQL 配置 ====================
DB_HOST=postgres-master
DB_PORT=5432
DB_NAME=campus_marketplace_prod
DB_USERNAME=
DB_PASSWORD=
DB_POOL_MIN_IDLE=20
DB_POOL_MAX_SIZE=100
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=600000
DB_MAX_LIFETIME=1800000
DB_POOL_NAME=CampusMarketplaceHikariCP

# ==================== JPA 配置 ====================
JPA_DDL_AUTO=validate
JPA_SHOW_SQL=false
JPA_FORMAT_SQL=false
JPA_ENABLE_LAZY_NO_TRANS=false
JPA_BATCH_SIZE=100
JPA_ORDER_INSERTS=true
JPA_ORDER_UPDATES=true
HIBERNATE_SECOND_LEVEL_CACHE=true
HIBERNATE_QUERY_CACHE=true

# ==================== Redis（生产可用 Sentinel）====================
# 方式一：直连单实例/主从（无 Sentinel）
REDIS_HOST=redis-master
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0

# 方式二：Sentinel（推荐生产）— 同时配置以下两项即启用
REDIS_SENTINEL_MASTER=mymaster
REDIS_SENTINEL_NODES=redis-sentinel-1:26379,redis-sentinel-2:26379,redis-sentinel-3:26379

# 连接池
REDIS_POOL_MAX_ACTIVE=200
REDIS_POOL_MAX_IDLE=50
REDIS_POOL_MIN_IDLE=10

# ==================== 邮件配置 ====================
MAIL_HOST=
MAIL_PORT=465
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_FROM_NAME=校园轻享集市

# ==================== JWT 配置 ====================
JWT_SECRET=
JWT_EXPIRATION=7200000
JWT_REFRESH_EXPIRATION=604800000

# ==================== 文件上传配置 ====================
FILE_UPLOAD_DIR=/app/uploads
FILE_ALLOWED_EXTENSIONS=jpg,jpeg,png,gif
FILE_MAX_SIZE=10MB
FILE_MAX_REQUEST_SIZE=50MB
FILE_UPLOAD_ENABLED=true

# ==================== 支付宝（正式网关）====================
ALIPAY_APP_ID=
ALIPAY_PRIVATE_KEY=
ALIPAY_PUBLIC_KEY=
ALIPAY_GATEWAY_URL=https://openapi.alipay.com/gateway.do
ALIPAY_NOTIFY_URL=https://your-domain.com/api/payment/alipay/notify
ALIPAY_RETURN_URL=https://your-domain.com/payment/result

# ==================== 微信支付（V3 正式）====================
WECHAT_PAY_VERSION=v3
WECHAT_APP_ID=
WECHAT_MCH_ID=
WECHAT_PRIVATE_KEY_PATH=/etc/keys/wechat/apiclient_key.pem
WECHAT_MERCHANT_SERIAL_NUMBER=
WECHAT_API_V3_KEY=
WECHAT_NOTIFY_URL=https://your-domain.com/api/payment/wechat/notify

# ==================== 佣金 & 限流 ====================
COMMISSION_RATE=0.01
COMMISSION_MIN_RATE=0.005
COMMISSION_MAX_RATE=0.05
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_LIMIT=300
RATE_LIMIT_DEFAULT_PERIOD=60

# ==================== 日志 & 观测 ====================
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=INFO
LOG_LEVEL_SQL=INFO
LOG_FILE_PATH=/var/log/campus-marketplace/app.log
LOG_FILE_MAX_SIZE=50MB
LOG_FILE_MAX_HISTORY=30
LOG_LEVEL_BINDER=WARN
LOG_LEVEL_SPRING_SECURITY=WARN
LOG_PATTERN_CONSOLE="%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
LOG_PATTERN_FILE="%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
LOG_DIR=/var/log/campus-marketplace
LOG_FILE_BASENAME=app
LOGBACK_PATTERN=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50}:%line - %msg%n
LOGBACK_PATTERN_COLOR=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50}:%line - %msg%n
SLOW_QUERY_LOG_MAX_HISTORY=14

# ==================== Actuator & 文档开关 ====================
ACTUATOR_ENDPOINTS=health,info,metrics,loggers
ACTUATOR_HEALTH_SHOW_DETAILS=when-authorized
ACTUATOR_BASE_PATH=/actuator
ACTUATOR_EXCLUDE=shutdown
PROMETHEUS_ENABLED=true
METRICS_HTTP_HISTOGRAM=true
TRACING_PROBABILITY=0.1
SPRINGDOC_ENABLED=false
SWAGGER_UI_ENABLED=false

# ==================== 调试开关 ====================
DEBUG_ENABLED=false
DEBUG_SHOW_ERROR_DETAILS=false

# ==================== Tomcat 线程池 ====================
TOMCAT_MAX_THREADS=400
TOMCAT_MIN_SPARE_THREADS=50

# ==================== JWT 头部配置 ====================
JWT_HEADER=Authorization
JWT_PREFIX="Bearer "

# ==================== Alipay 附加参数 ====================
ALIPAY_FORMAT=json
ALIPAY_SIGN_TYPE=RSA2
ALIPAY_CHARSET=UTF-8
