# æ ¡å›­è½»äº«é›†å¸‚ç³»ç»Ÿ - å‰ç«¯æ¶æ„è“å›¾ v3.0

> **ä½œè€…**: BaSui ğŸ˜  
> **æœ€è¿‘æ›´æ–°**: 2025-10-31  
> **é€‚ç”¨ä»£ç åŸºçº¿**: main åˆ†æ”¯ @ 2025-10-31

---

## 1. æ–‡æ¡£æ¦‚è¿°
- ç›®æ ‡ï¼šç»Ÿä¸€å‰ç«¯ Monorepo æ¶æ„è®¤çŸ¥ï¼ŒæŒ‡å¯¼ Portalï¼ˆç”¨æˆ·ç«¯ï¼‰ä¸ Adminï¼ˆç®¡ç†ç«¯ï¼‰åœ¨åŒä¸€æŠ€æœ¯æ ˆä¸‹é«˜æ•ˆåä½œï¼Œå¹¶ç¡®ä¿ä¸åç«¯çš„å¥‘çº¦æ”¶æ•›ã€‚
- èŒƒå›´ï¼š`frontend/` å·¥ä½œåŒºçš„æ¶æ„è®¾è®¡ã€æŠ€æœ¯æ ˆé€‰å‹ã€æ¨¡å—èŒè´£ã€ç ”å‘è®¡åˆ’ã€é£é™©è¯„ä¼°ä¸æ‰©å±•ç­–ç•¥ã€‚
- çŠ¶æ€ï¼šå…¬å…±å±‚ `@campus/shared` å·²å®Œæˆæ ¸å¿ƒèƒ½åŠ›æ²‰æ·€ï¼ŒPortal è¿›å…¥é¡µé¢å¼€å‘ç­¹å¤‡é˜¶æ®µï¼ŒAdmin å¤„äºè„šæ‰‹æ¶çŠ¶æ€ç­‰å¾…ä¸šåŠ¡æ¨¡å—æ¥å…¥ã€‚
- é¢å‘è§’è‰²ï¼šå‰ç«¯å¼€å‘ã€å…¨æ ˆå¼€å‘ã€æ¶æ„å¸ˆã€æµ‹è¯•ã€äº§å“/é¡¹ç›®ç®¡ç†ã€‚

---

## 2. æ¶æ„æ€»è§ˆ

### 2.1 Monorepo æ‹“æ‰‘
```
frontend/ (pnpm workspace)
â”œâ”€â”€ packages/shared   # å…¬å…±å±‚ï¼šç»„ä»¶ã€OpenAPI å®¢æˆ·ç«¯ã€å·¥å…·ã€ç±»å‹ã€Hook
â”œâ”€â”€ packages/portal   # ç”¨æˆ·ç«¯ï¼šReact + Tailwind + React Query + Zustand
â””â”€â”€ packages/admin    # ç®¡ç†ç«¯ï¼šReact + Ant Design + React Query + Zustand
```

- **ç»Ÿä¸€ä¾èµ–**ï¼šæ ¹ `package.json` ç®¡ç†æ ¼å¼åŒ–ã€Lintã€API ç”Ÿæˆç­‰é€šç”¨ä»»åŠ¡ã€‚
- **è¯­ä¹‰ç‰ˆæœ¬**ï¼šå„åŒ…ä½¿ç”¨ workspace åè®®ï¼Œä¿æŒå†…éƒ¨åŒæ­¥ç‰ˆæœ¬ã€‚
- **è·¨åŒ…å¼•ç”¨**ï¼šé€šè¿‡ `import {...} from '@campus/shared'` å…±äº«å…¨éƒ¨å…¬å…±èƒ½åŠ›ã€‚

### 2.2 è¿è¡Œæ—¶ç»„ä»¶
| å±‚çº§ | è¯´æ˜ | å…³é”®èƒ½åŠ› |
| ---- | ---- | -------- |
| `@campus/shared` | é€šç”¨åŸºç¡€è®¾æ–½å±‚ | UI ç»„ä»¶åº“ã€HTTP å®¢æˆ·ç«¯ã€WebSocket å®¢æˆ·ç«¯ã€çŠ¶æ€ Hookã€ç±»å‹ç³»ç»Ÿã€å¸¸é‡ã€å·¥å…·å‡½æ•° |
| `@campus/portal` | C ç«¯ Web åº”ç”¨ï¼ˆPC + ç§»åŠ¨é€‚é…ï¼‰ | ç™»å½•æ³¨å†Œã€å•†å“æµè§ˆã€å‘å¸ƒã€èŠå¤©ã€è®¢å•ã€ç¤¾åŒºã€é€šçŸ¥ï¼ˆå¾…å¼€å‘ï¼‰ |
| `@campus/admin` | ç®¡ç†åå°ï¼ˆPCï¼‰ | ç”¨æˆ·æ²»ç†ã€å®¡æ ¸ã€è¿è¥ã€æŠ¥è¡¨ã€é…ç½®ï¼ˆè§„åˆ’ä¸­ï¼‰ |

---

## 3. æŠ€æœ¯æ ˆé€‰å‹

### 3.1 å…¬å…±å±‚ï¼ˆ@campus/sharedï¼‰
- TypeScript 5.5ï¼Œä¸¥æ ¼å¼€å¯ `strict` é€‰é¡¹ï¼Œç»Ÿä¸€ç±»å‹è¾“å‡ºã€‚
- React 18 / JSX Runtimeï¼Œç”¨äºå…¬å…±ç»„ä»¶ä¸ç¤ºä¾‹æµ‹è¯•ã€‚
- Axios + `@tanstack/react-query`ï¼šæä¾›è¯·æ±‚å°è£…ã€ç¼“å­˜ã€é”™è¯¯å¤„ç†èƒ½åŠ›ã€‚
- Zustand Middlewareï¼ˆpersist / immerï¼‰ç”¨äºå¯é€‰çš„è½»é‡çŠ¶æ€ï¼›å¤§éƒ¨åˆ†é€šç”¨é€»è¾‘æŠ½è±¡ä¸º Hookã€‚
- æ„å»ºå·¥å…· tsupï¼ˆESM + CJS åŒäº§ç‰©ï¼‰ï¼Œä¾¿äºå¤šç¯å¢ƒå¤ç”¨ã€‚
- OpenAPI Generator è¾“å‡ºä½äº `src/api`ï¼Œé€šè¿‡ `pnpm run api:generate` è‡ªåŠ¨ç”Ÿæˆã€‚

### 3.2 ç”¨æˆ·ç«¯ï¼ˆ@campus/portalï¼‰
- React 18 + Vite 5ï¼šå¿«é€Ÿå¼€å‘ä½“éªŒã€è‡ªåŠ¨ä»£ç æ‹†åˆ†ã€‚
- Tailwind CSS + PostCSSï¼šç»Ÿä¸€æ ·å¼ç³»ç»Ÿï¼Œå…¼é¡¾ç§»åŠ¨ç«¯é€‚é…ã€‚
- React Router 6ï¼šå£°æ˜å¼è·¯ç”±é…ç½®ï¼ˆåµŒå¥—è·¯ç”± + æ‡’åŠ è½½ï¼‰ã€‚
- Zustandï¼šæœ¬åœ°å³æ—¶çŠ¶æ€ï¼ˆç™»å½•æ€ã€é€šçŸ¥é˜Ÿåˆ—ç­‰ï¼‰ã€‚
- React Queryï¼šæœåŠ¡ç«¯çŠ¶æ€åŒæ­¥ï¼Œæ”¯æŒåˆ†é¡µã€ç¼“å­˜ã€é‡è¯•ã€‚
- WebSocket å®¢æˆ·ç«¯ï¼šåŸºäºå…±äº«å±‚å°è£…çš„ `WebSocketClient` + Hookã€‚

### 3.3 ç®¡ç†ç«¯ï¼ˆ@campus/adminï¼‰
- React 18 + Vite 5ï¼šä¸ Portal ä¿æŒä¸€è‡´çš„æ„å»ºä½“éªŒã€‚
- Ant Design 5ï¼šå¿«é€Ÿæ„å»ºè¡¨å•ã€åˆ—è¡¨ã€å›¾è¡¨ï¼Œä¸åç«¯è¿è¥åœºæ™¯åŒ¹é…ã€‚
- React Query + Zustandï¼šåŒ Portal çš„æ•°æ®è®¿é—®ä¸çŠ¶æ€ç­–ç•¥ã€‚
- é¢„ç•™ä¸»é¢˜å®šåˆ¶ä¸å›½é™…åŒ–å…¥å£ï¼Œåç»­æ ¹æ®è¿è¥éœ€æ±‚æ‰©å±•ã€‚

### 3.4 æ–¹æ¡ˆå¯¹æ¯”ä¸å†³ç­–
| æ–¹æ¡ˆ | æ ¸å¿ƒç»„ä»¶ | ç”Ÿæ€æˆç†Ÿåº¦ | å›¢é˜Ÿå­¦ä¹ æˆæœ¬ | å’Œå…±äº«å±‚è€¦åˆåº¦ | ç»“è®º |
| ---- | -------- | ---------- | -------------- | --------------- | ---- |
| **React + pnpm Monorepoï¼ˆç°è¡Œï¼‰** | React 18ã€Tailwindã€AntDã€Zustand | â­â­â­â­ | â­â­â­ | ä¸å…±äº«å±‚å®Œå…¨ä¸€è‡´ï¼Œé›¶èƒ¶æ°´ | âœ… ç»§ç»­æ¨è¿› |
| Vue 3 + Vite + Pinia | Element Plusã€Vant | â­â­â­ | â­â­ | éœ€è¦é‡å†™å…±äº«å±‚ç»„ä»¶ï¼ŒAPI å®¢æˆ·ç«¯å¯å¤ç”¨ | âŒ æ”¾å¼ƒï¼ˆæˆæœ¬é«˜ï¼‰ |
| React å¾®å‰ç«¯ï¼ˆModule Federationï¼‰| ä»»æ„ | â­â­ | â­â­â­â­ | å…±äº«å±‚éœ€è¦é¢å¤–æ‰“åŒ…é…ç½® | âŒ æš‚ä¸é‡‡ç”¨ |

> ç»“è®ºï¼šå›¢é˜Ÿå·²æœ‰ React ç»éªŒï¼Œå…¬å…±å±‚å·²åŸºäº React å®ç°ï¼Œç»§ç»­æ·±è€•ç°æœ‰æ–¹æ¡ˆå¯æœ€å¤§åŒ–å¤ç”¨æˆæœã€‚

---

## 4. é¡¹ç›®ç»“æ„ï¼ˆå…³é”®æ–‡ä»¶ï¼‰
```
frontend/
â”œâ”€â”€ package.json                # æ ¹è„šæœ¬ï¼šdev/build/lint/type-check/api:generate
â”œâ”€â”€ pnpm-workspace.yaml         # workspace åˆ—è¡¨ï¼ˆshared / portal / adminï¼‰
â”œâ”€â”€ packages
â”‚   â”œâ”€â”€ shared
â”‚   â”‚   â”œâ”€â”€ src
â”‚   â”‚   â”‚   â”œâ”€â”€ api/            # OpenAPI ç”Ÿæˆï¼ˆHTML/JSON/SARIF åŒæºï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ components/     # Avatar/Button/Card/Table/... 18 ä¸ªåŸå­ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ constants/      # config.tsã€enum.tsã€status.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/          # useAuth/useRequest/useWebSocket/... 13 ä¸ª Hook
â”‚   â”‚   â”‚   â”œâ”€â”€ services/       # auth/goods/order/post/... 10 å¤§é¢†åŸŸæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ types/          # API/å®ä½“/æšä¸¾äº¤å‰ç±»å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/          # http.ts/storage.ts/validator.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts        # ç»Ÿä¸€å¯¼å‡ºå…¥å£
â”‚   â”‚   â””â”€â”€ tsup.config.ts      # å…¬å…±å±‚æ‰“åŒ…é…ç½®
â”‚   â”œâ”€â”€ portal
â”‚   â”‚   â”œâ”€â”€ src
â”‚   â”‚   â”‚   â”œâ”€â”€ layouts/        # MainLayout/AuthLayout
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/          # Home/GoodsDetail/Publish/Chat/...ï¼ˆéª¨æ¶å°±ç»ªï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ router/         # index.tsxï¼šæ‡’åŠ è½½ + å®ˆå«
â”‚   â”‚   â”‚   â”œâ”€â”€ store/          # useAuthStore/useNotificationStore
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx         # QueryClientProvider + WebSocket åˆå§‹åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ main.tsx        # æ¸²æŸ“å…¥å£
â”‚   â”‚   â””â”€â”€ tailwind.config.js  # æ ·å¼ä½“ç³»
â”‚   â””â”€â”€ admin
â”‚       â”œâ”€â”€ src/App.tsx         # è„šæ‰‹æ¶ï¼ˆå¾…æ¥å…¥ Ant Designï¼‰
â”‚       â””â”€â”€ å…¶ä»– Vite é»˜è®¤æ–‡ä»¶
â””â”€â”€ README.md                   # å‰ç«¯ Monorepo æŒ‡å—
```

---

## 5. æ ¸å¿ƒæ¨¡å—åˆ†è§£

### 5.1 å…¬å…±å±‚èƒ½åŠ›çŸ©é˜µ
| æ¨¡å— | ä»£è¡¨æ–‡ä»¶ | åŠŸèƒ½æ‘˜è¦ | å…³è”åç«¯æ¨¡å— |
| ---- | -------- | -------- | ------------ |
| UI ç»„ä»¶ | `components/Button/Button.tsx`ã€`components/Table/Table.tsx` | è¦†ç›–æŒ‰é’®ã€å¡ç‰‡ã€ä¸Šä¼ ã€å¯Œæ–‡æœ¬ã€åˆ†é¡µã€Tabã€Toast ç­‰å¸¸ç”¨æ¨¡å¼ï¼Œå¯åœ¨ Portal/Admin ç›´æ¥å¤ç”¨ | Controller å±‚è¿”å›çš„æ•°æ®é€šè¿‡ç»„ä»¶æ¸²æŸ“ |
| Hook | `hooks/useAuth.ts`ã€`hooks/useWebSocketService.ts` | å°è£…ç™»å½•æ€ã€è¯·æ±‚èŠ‚æµã€é˜²æŠ–ã€æ–‡ä»¶ä¸Šä¼ ã€æ¶ˆæ¯è®¢é˜…ç­‰é¢†åŸŸé€»è¾‘ | `AuthController`ã€`MessageController` ç­‰ |
| æœåŠ¡ | `services/auth.ts`ã€`services/order.ts`ã€`services/websocket.ts` | å¯¹åç«¯ REST/WebSocket ç»Ÿä¸€å°è£…ï¼Œè‡ªåŠ¨å¸¦ä¸Š Tokenã€é”™è¯¯æç¤ºã€é‡è¿ç­–ç•¥ | å„ä¸šåŠ¡ Serviceï¼ˆè®¢å•ã€å¸–å­ã€æ¶ˆæ¯ç­‰ï¼‰ |
| å·¥å…· | `utils/http.ts`ã€`utils/storage.ts` | Axios å®ä¾‹ + æ‹¦æˆªå™¨ã€åŠ è§£å¯†ã€LocalStorage æŒä¹…åŒ–ã€å‚æ•°æ ¼å¼åŒ– | HTTP å±‚é€šç”¨ |
| å¸¸é‡ | `constants/config.ts`ã€`constants/status.ts` | API æ ¹è·¯å¾„ã€ä¸šåŠ¡æšä¸¾ã€è¶…æ—¶ã€çº¦æŸé˜ˆå€¼ | ä¸åç«¯ `PermissionCodes`ã€`OrderStatus` ç­‰æšä¸¾å¯¹é½ |
| ç±»å‹ | `types/api.ts`ã€`types/entity.ts` | å°† OpenAPI Schemaã€é¢†åŸŸæ¨¡å‹ç»Ÿä¸€æˆ TypeScript ç±»å‹ | JPA Entity / DTO |
| API | `api/api.ts`ã€`api/models/*` | OpenAPI ç”Ÿæˆçš„å®¢æˆ·ç«¯ï¼›å†ç”± `services/*` åšäºŒæ¬¡å°è£… | OpenAPI å¯¼å‡º (`target/openapi-frontend.json`) |

### 5.2 Portalï¼ˆç”¨æˆ·ç«¯ï¼‰ç°çŠ¶
- **è·¯ç”±ä½“ç³»**ï¼š`src/router/index.tsx` é‡‡ç”¨ `createBrowserRouter`ï¼Œæ”¯æŒæ‡’åŠ è½½ã€å®ˆå«ï¼ˆç™»å½•å‰åé‡å®šå‘ï¼‰ã€‚
- **çŠ¶æ€ç®¡ç†**ï¼š`useAuthStore` è´Ÿè´£ Token æŒä¹…åŒ–ï¼ˆLocalStorage + Refresh Tokenï¼‰ã€è‡ªåŠ¨ç»­æœŸï¼›`useNotificationStore` è´Ÿè´£å…¨å±€æç¤ºã€‚
- **WebSocket**ï¼šåœ¨ `App.tsx` ä¸­è°ƒç”¨ `useWebSocketService`ï¼Œæ”¯æŒè‡ªåŠ¨é‡è¿ã€é”™è¯¯æ—¥å¿—ã€‚
- **é¡µé¢è„šæ‰‹æ¶**ï¼šä¹å¤§é¡µé¢ç›®å½•å·²åˆ›å»ºï¼Œå¾…å¡«å……å®é™… UI/æ¥å£è°ƒç”¨ã€‚
- **æ ·å¼è§„èŒƒ**ï¼šTailwind + å…¨å±€ CSSï¼Œä¸»è‰²è°ƒã€é—´è·ã€å“åº”å¼æ–­ç‚¹å·²å®šä¹‰ã€‚

### 5.3 Adminï¼ˆç®¡ç†ç«¯ï¼‰è®¡åˆ’
- å½“å‰ä¸º Vite é»˜è®¤æ¨¡æ¿ï¼Œéœ€è¦æŒ‰ä»¥ä¸‹é¡ºåºè¡¥é½ï¼š
  1. é›†æˆ Ant Design + ä¸­æ–‡åŒ–ï¼›
  2. æ­å»ºä¾§è¾¹å¯¼èˆªã€æƒé™è·¯ç”±å®ˆå«ï¼›
  3. å¼•å…¥å…±äº«å±‚ç»„ä»¶ï¼ˆè¡¨æ ¼ã€è¡¨å•ã€å¼¹çª—ï¼‰ä¸æœåŠ¡ï¼›
  4. æ„å»ºæ ¸å¿ƒé¡µé¢ï¼ˆä»ªè¡¨ç›˜ã€ç”¨æˆ·ç®¡ç†ã€å®¡æ ¸å·¥ä½œå°ã€é™æµé…ç½®ç­‰ï¼‰ã€‚
- ä¸ Portal å…±ç”¨çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚è®¢å•ã€å•†å“ã€é€šçŸ¥ï¼‰ä¼˜å…ˆæ”¾å…¥ sharedï¼ŒAdmin ä»…å…³æ³¨ç•Œé¢ç¼–æ’ä¸æƒé™æ§åˆ¶ã€‚

---

## 6. æ•°æ®æµä¸åç«¯ååŒ

### 6.1 èº«ä»½è®¤è¯æµç¨‹
1. ç”¨æˆ·åœ¨ Portal é€šè¿‡ `authService.login` æäº¤ç™»å½•è¯·æ±‚ï¼›
2. è¿”å›çš„ `accessToken/refreshToken` ç”± `useAuthStore` å­˜å…¥ LocalStorageï¼Œå¹¶æ›´æ–°å…¨å±€çŠ¶æ€ï¼›
3. `axios` æ‹¦æˆªå™¨è‡ªåŠ¨æŠŠ Token æ³¨å…¥è¯·æ±‚å¤´ï¼Œ401 æ—¶è§¦å‘åˆ·æ–°é€»è¾‘ï¼›
4. WebSocket è¿æ¥ä½¿ç”¨åŒæ ·çš„ Token è¿›è¡Œé‰´æƒã€‚

### 6.2 API è°ƒç”¨é“¾
```
ç»„ä»¶ / é¡µé¢
   â†“ è°ƒç”¨
services/*.ts ï¼ˆä¸šåŠ¡å°è£…ï¼Œå«é”™è¯¯æç¤ºã€å‚æ•°è½¬æ¢ï¼‰
   â†“
@campus/shared/api/* ï¼ˆOpenAPI è‡ªåŠ¨ç”Ÿæˆçš„å®¢æˆ·ç«¯ï¼‰
   â†“
åç«¯ REST æ§åˆ¶å™¨
```
- æ‰€æœ‰æœåŠ¡é»˜è®¤è¿”å› `ApiResponse<T>`ï¼Œåœ¨æœåŠ¡å±‚ç»Ÿä¸€è§£åŒ… `data` å¹¶å¤„ç†å¼‚å¸¸ä¿¡æ¯ã€‚
- é€šè¿‡ React Query çš„ `queryKey` çº¦å®šï¼ˆå¦‚ `['goods','list',filters]`ï¼‰ç®¡ç†ç¼“å­˜ä¸å¤±æ•ˆã€‚

### 6.3 WebSocket åè®®
- åœ°å€ï¼š`ws://<host>/ws`ï¼ˆä¸åç«¯ `WebSocketConfig` å¯¹é½ï¼‰ã€‚
- å®¢æˆ·ç«¯ï¼š`services/WebSocketClient.ts` æ”¯æŒå¿ƒè·³ï¼ˆé»˜è®¤ 30sï¼‰ã€è‡ªåŠ¨é‡è¿ã€æ¶ˆæ¯åˆ†å‘ã€‚
- Hookï¼š`useWebSocketService` æ¥æ”¶å›è°ƒ `onOpen/onClose/onMessage`ï¼ŒPortal åœ¨æ ¹ç»„ä»¶å®Œæˆåˆå§‹åŒ–ã€‚

### 6.4 æ„å»ºä¸äº¤ä»˜
- `pnpm run dev:*`ï¼šVite å¼€å‘æœåŠ¡å™¨ï¼ˆHMRï¼‰ã€‚
- `pnpm run build:*`ï¼šVite + tsup äº§ç‰©ï¼ŒPortal/Admin è¾“å‡ºé™æ€èµ„æºï¼Œshared è¾“å‡ºåº“æ¨¡å¼ã€‚
- `pnpm -r lint`ã€`pnpm -r type-check`ï¼šå¤šåŒ…å¹¶è¡Œæ ¡éªŒã€‚
- æ„å»ºäº§ç‰©å¯ç›´æ¥æŒ‚è½½è‡³ `docker/nginx/conf.d` æ‰€æŒ‡çš„é™æ€ç›®å½•ä»¥ä¾› Nginx æœåŠ¡ã€‚

### 6.5 é”™è¯¯ç›‘æ§ä¸æ—¥å¿—
- Axios æ‹¦æˆªå™¨ç»Ÿä¸€æ‰“å°é”™è¯¯ï¼ˆå¾…æ¥å…¥ Sentry/é˜¿é‡Œ ARMSï¼‰ã€‚
- WebSocket å®¢æˆ·ç«¯åœ¨æ§åˆ¶å°è¾“å‡ºè¿æ¥çŠ¶æ€ï¼Œåç»­å¯å¢åŠ è‡ªå®šä¹‰äº‹ä»¶ä¸ŠæŠ¥ã€‚

---

## 7. éåŠŸèƒ½æ€§è¦æ±‚
| åˆ†ç±» | è¦ç‚¹ | å½“å‰çŠ¶æ€ | ä¸‹ä¸€æ­¥ |
| ---- | ---- | -------- | ------ |
| æ€§èƒ½ | Vite æ‰“åŒ…ã€ä»£ç åˆ†å‰²ã€Tailwind JITï¼›React Query ç¼“å­˜ | âœ… åŸºç¡€èƒ½åŠ›å°±ç»ª | é…ç½®åŠ¨æ€å¯¼å…¥ã€å›¾ç‰‡æ‡’åŠ è½½ã€éª¨æ¶å± |
| å®‰å…¨ | JWT å­˜å‚¨åœ¨ LocalStorageï¼ˆçŸ­æœ‰æ•ˆæœŸ + Refreshï¼‰ï¼›Axios é‡è¯•ä»…é’ˆå¯¹å¹‚ç­‰è¯·æ±‚ | âœ… | å¼•å…¥ CSPã€XSS è¿‡æ»¤ã€åŠ å›ºé€€å‡ºé€»è¾‘ |
| å¯ç»´æŠ¤ | ESLint 9 + TypeScriptã€Prettierã€lint-stagedï¼›shared ä¿æŒå•ä¸€å‡ºå£ | âœ… | å»ºç«‹ Storybook/Unit Test è¦†ç›–ç‡ç›®æ ‡ |
| è§‚æµ‹ | ç»Ÿä¸€ä½¿ç”¨æµè§ˆå™¨æ§åˆ¶å° + åç«¯å®¡è®¡ï¼›è®¡åˆ’æ¥å…¥åŸ‹ç‚¹ | â³ | ç»“åˆåç«¯ AuditLogï¼Œè®¾è®¡å‰ç«¯åŸ‹ç‚¹è§„èŒƒ |
| å¯è®¿é—®æ€§ | Tailwind è¯­ä¹‰åŒ– classï¼Œç»„ä»¶åŠ å…¥ ARIA å±æ€§ | â³ | ç¼–å†™ A11y Checklistï¼Œæ”¯æŒé”®ç›˜æ“ä½œ |

---

## 8. ç ”å‘è®¡åˆ’ä¸é‡Œç¨‹ç¢‘
| é˜¶æ®µ | æ—¶é—´çª—å£ | ç›®æ ‡ | å…³é”®äº¤ä»˜ |
| ---- | -------- | ---- | -------- |
| Stage 0 âœ… | å·²å®Œæˆ | Monorepo æ¡†æ¶ã€å…¬å…±å±‚åŸºç¡€è®¾æ–½ã€API å®¢æˆ·ç«¯è¿ç§» | shared ç»„ä»¶/Hook/æœåŠ¡é›å½¢ï¼ŒPortal è·¯ç”±/çŠ¶æ€éª¨æ¶ |
| Stage 1 | 2025-11-01 ~ 2025-11-10 | å¼ºåŒ– sharedï¼ˆè¡¨å•æ ¡éªŒã€ä¸Šä¼ ã€å¯Œæ–‡æœ¬ã€WebSocket å°è£…å®Œå–„ï¼‰ | å®Œæˆç»„ä»¶æ–‡æ¡£ã€æœåŠ¡é”™è¯¯ç è§„èŒƒã€ç¤ºä¾‹é¡µ |
| Stage 2 | 2025-11-11 ~ 2025-12-05 | Portal MVPï¼ˆè®¤è¯ > å•†å“ > è®¢å• > æ¶ˆæ¯ > ç¤¾åŒºï¼‰ | ä¸»è¦é¡µé¢ UI + æ¥å£è”è°ƒ + å•æµ‹è¦†ç›– â‰¥ 50% |
| Stage 3 | 2025-12-06 ~ 2026-01-05 | Admin æ ¸å¿ƒèƒ½åŠ›ï¼ˆä»ªè¡¨ç›˜ã€å®¡æ ¸ã€é£æ§é…ç½®ã€é€šçŸ¥ä¸­å¿ƒï¼‰ | å®Œæˆå¤šè§’è‰²è·¯ç”±ã€æƒé™å®ˆå«ã€AntD ä¸»é¢˜ã€è¡¨æ ¼æ“ä½œæµç¨‹ |
| Stage 4 | 2026-01-06 ~ 2026-01-20 | è‡ªåŠ¨åŒ–ä¸ä½“éªŒï¼ˆE2Eã€æ€§èƒ½ä¼˜åŒ–ã€ç›‘æ§ï¼‰ | Cypress/Playwright æµ‹è¯•ã€Lighthouse â‰¥ 85ã€æ—¥å¿—/åŸ‹ç‚¹æ–¹æ¡ˆ |
| Stage 5 | 2026-01-21+ | å°ç¨‹åº/Hybrid æ‰©å±•é¢„ç ” | å…±äº«å±‚å…¼å®¹æ€§è¯„ä¼°ã€API é€‚é…å±‚è®¾è®¡ |

---

## 9. é£é™©ä¸ç¼“è§£æªæ–½
| é£é™© | å½±å“ | ç¼“è§£ç­–ç•¥ |
| ---- | ---- | -------- |
| åç«¯æ¥å£é¢‘ç¹å˜æ›´å¯¼è‡´ç±»å‹ä¸ä¸€è‡´ | ç¼–è¯‘å¤±è´¥æˆ–è¿è¡ŒæœŸé”™è¯¯ | å›ºå®š API ç”Ÿæˆæµç¨‹ï¼šåç«¯å¯¼å‡º OpenAPI â†’ `pnpm run api:generate` â†’ `pnpm -r type-check`ï¼›å»ºç«‹ç‰ˆæœ¬æ ‡ç­¾ |
| WebSocket æ¶ˆæ¯é£æš´å ç”¨ä¸»çº¿ç¨‹ | é¡µé¢å¡é¡¿ã€æ¶ˆæ¯ä¸¢å¤± | åœ¨ shared ä¸­å¢åŠ æ¶ˆæ¯é˜Ÿåˆ—ä¸èŠ‚æµï¼›å¯¹å¤§æ•°æ®é‡æ”¹ç”¨åˆ†é¡µæ‹‰å–ï¼›ç›‘æ§è¿æ¥æ•° |
| Admin å¼€å‘èµ„æºä¸è¶³ | åå°äº¤ä»˜å»¶è¿Ÿ | å…±äº«å±‚æä¾›è¿è¥åœºæ™¯æ¨¡æ¿ï¼›ä¼˜å…ˆè½å®é«˜ä»·å€¼æ¨¡å—ï¼ˆç”¨æˆ·ã€å®¡æ ¸ï¼‰ï¼›è€ƒè™‘å¼•å…¥ç»„ä»¶æ‹–æ‹½å·¥å…· |
| Tailwind ä½¿ç”¨ä¸å½“å¯¼è‡´æ ·å¼å¤±æ§ | æ ·å¼æ··ä¹±ã€é‡å¤ç±»å | åˆ¶å®šå‘½åçº¦å®šã€å°è£…å¸¸ç”¨ç»„ä»¶åˆ° sharedã€å¼•å…¥ Stylelint Tailwind æ’ä»¶ |

---

## 10. æ‰©å±•æ€è€ƒ
- **ç§»åŠ¨ç«¯/å°ç¨‹åº**ï¼šå¯åœ¨ shared ä¸­æ–°å¢ uni-app é€‚é…å±‚ï¼Œä¿æŒ API ä¸æœåŠ¡ä¸€è‡´ï¼Œå†æŒ‰éœ€è¾“å‡ºè½»é‡ UIã€‚
- **å¾®å‰ç«¯**ï¼šè‹¥æœªæ¥éœ€è¦æ‹†åˆ†éƒ¨ç½²ï¼Œå¯å°† Admin/Portal åˆ†åˆ«ä½œä¸ºç‹¬ç«‹æ„å»ºäº§ç‰©ï¼Œé€šè¿‡ Nginx è·¯ç”±æˆ– Module Federation.
- **è®¾è®¡ç³»ç»Ÿ**ï¼šå»ºè®®åœ¨ shared åŸºç¡€ä¸Šæ­å»º Storybookï¼Œæ²‰æ·€è®¾è®¡è§„èŒƒä¸äº¤äº’æ‰‹å†Œã€‚

---

## 11. é™„å½•

### 11.1 å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥
| å‘½ä»¤ | åœºæ™¯ |
| ---- | ---- |
| `pnpm install` | å®‰è£…ä¾èµ–ï¼ˆæ ¹ç›®å½•æ‰§è¡Œï¼‰ |
| `pnpm run dev:portal` / `pnpm run dev:admin` | å¯åŠ¨å•åº”ç”¨å¼€å‘æœåŠ¡å™¨ |
| `pnpm run build:all` | æ„å»º shared + portal + admin |
| `pnpm -r lint` / `pnpm -r type-check` | å…¨é‡ Lint / ç±»å‹æ£€æŸ¥ |
| `pnpm run api:generate` | ä»åç«¯å¯¼å‡ºæœ€æ–° OpenAPI å¹¶ç”Ÿæˆå®¢æˆ·ç«¯ |

### 11.2 ç›®å½•ç´¢å¼•ï¼ˆæŒ‰åŠŸèƒ½ï¼‰
| åŠŸèƒ½ | å…³é”®æ–‡ä»¶ |
| ---- | -------- |
| è®¤è¯çŠ¶æ€ | `packages/shared/src/hooks/useAuth.ts`ã€`packages/portal/src/store/useAuthStore.ts` |
| å•†å“æœåŠ¡ | `packages/shared/src/services/goods.ts`ã€`packages/shared/src/components/GoodsCard` |
| æ¶ˆæ¯ä¸­å¿ƒ | `packages/shared/src/services/message.ts`ã€`packages/shared/src/services/WebSocketClient.ts` |
| ä¸Šä¼ èƒ½åŠ› | `packages/shared/src/components/ImageUpload`ã€`packages/shared/src/hooks/useUpload.ts` |
| é€šçŸ¥ç»„ä»¶ | `packages/shared/src/components/Toast`ã€`packages/shared/src/hooks/useNotification.ts` |

---

> **ä¸‹ä¸€æ­¥å»ºè®®**ï¼šä¼˜å…ˆè¡¥é½ shared æ–‡æ¡£ä¸å•æµ‹ï¼ˆStage 1ï¼‰ï¼Œéšåæ¨è¿› Portal MVP é¡µé¢å®ç°ï¼Œå¹¶åœ¨æ¯ä¸ªè¿­ä»£ç»“æŸæ—¶è¿è¡Œ `pnpm -r lint && pnpm -r type-check && pnpm run build:all` ç¡®è®¤å¯äº¤ä»˜æ€§ã€‚
