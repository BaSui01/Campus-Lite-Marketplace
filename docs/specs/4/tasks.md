# æ‰¹é‡æ“ä½œç³»ç»Ÿä»»åŠ¡åˆ†è§£

## Overview

åŸºäºæ‰¹é‡æ“ä½œç³»ç»Ÿçš„è®¾è®¡æ–‡æ¡£ï¼Œå°†ç³»ç»Ÿå¼€å‘åˆ†è§£ä¸ºç‹¬ç«‹çš„ã€åŸå­æ€§çš„å¼€å‘ä»»åŠ¡ã€‚æ¯ä¸ªä»»åŠ¡éµå¾ªTDDåŸåˆ™ï¼ŒåŒ…å«å®Œæ•´çš„æµ‹è¯•ã€å®ç°å’ŒéªŒè¯æ­¥éª¤ï¼Œç¡®ä¿ä»£ç è´¨é‡å’ŒåŠŸèƒ½å®Œæ•´æ€§ã€‚

## Task Breakdown

### ğŸ“¦ ä»»åŠ¡ 1: æ‰¹é‡ä»»åŠ¡æ ¸å¿ƒæ¶æ„ [x]

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: æ¶æ„å·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒæ¶æ„ï¼ŒåŒ…æ‹¬BatchTaskã€BatchTaskItemå®ä½“ã€ä»»åŠ¡ç¼–æ’å™¨ã€å¤„ç†å™¨å·¥å‚ç­‰æ ¸å¿ƒç»„ä»¶ï¼Œä¸ºæ‰¹é‡æ“ä½œæä¾›ç¨³å®šçš„åŸºç¡€è®¾æ–½ã€‚
**Constraints**:
- æ¶æ„è®¾è®¡å¿…é¡»æ”¯æŒå¤šç§æ‰¹é‡æ“ä½œç±»å‹çš„æ‰©å±•
- ä»»åŠ¡ç¼–æ’å¿…é¡»æ”¯æŒåˆ†ç‰‡å¤„ç†å’Œå¼‚æ­¥æ‰§è¡Œ
- å¤„ç†å™¨å·¥å‚å¿…é¡»é‡‡ç”¨ç­–ç•¥æ¨¡å¼ï¼Œæ”¯æŒæ’ä»¶åŒ–æ‰©å±•
- ä»»åŠ¡çŠ¶æ€ç®¡ç†å¿…é¡»æ”¯æŒäº‹åŠ¡ä¸€è‡´æ€§
- æ ¸å¿ƒç»„ä»¶å¿…é¡»æœ‰å®Œæ•´çš„ç›‘æ§å’Œæ—¥å¿—è®°å½•
**_Leverage**: ç°æœ‰çš„BaseEntityã€JPAé…ç½®ã€Springå¼‚æ­¥å¤„ç†ã€ç­–ç•¥æ¨¡å¼å®ç°ã€åˆ†å¸ƒå¼é”
**_Requirements**: éœ€æ±‚74(å•†å“æ‰¹é‡ä¸Šä¸‹æ¶)ã€éœ€æ±‚75(ä»·æ ¼æ‰¹é‡è°ƒæ•´)ã€éœ€æ±‚76(åº“å­˜æ‰¹é‡æ›´æ–°)ã€éœ€æ±‚77(æ‰¹é‡ç”¨æˆ·é€šçŸ¥)
**Success**:
- æ‰¹é‡ä»»åŠ¡æ¶æ„ç¨³å®šï¼Œæ”¯æŒé«˜å¹¶å‘å¤„ç†
- åˆ†ç‰‡ç­–ç•¥æœ‰æ•ˆï¼Œèƒ½å¤Ÿå¤„ç†è¶…å¤§æ‰¹é‡æ•°æ®
- å¤„ç†å™¨å·¥å‚è®¾è®¡åˆç†ï¼Œæ˜“äºæ‰©å±•æ–°æ“ä½œç±»å‹
- ä»»åŠ¡çŠ¶æ€ç®¡ç†å‡†ç¡®ï¼Œæ”¯æŒå¼‚å¸¸æ¢å¤
- æ¶æ„æ€§èƒ½è¾¾æ ‡ï¼Œæ»¡è¶³è®¾è®¡è¦æ±‚
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. ç¼–å†™æ ¸å¿ƒæ¶æ„çš„å¤±è´¥æµ‹è¯•
2. å®ç°BatchTaskå’ŒBatchTaskItemå®ä½“
3. å®ç°BatchTaskOrchestratorä»»åŠ¡ç¼–æ’å™¨
4. å®ç°BatchProcessorFactoryå¤„ç†å™¨å·¥å‚
5. å®ç°ä»»åŠ¡çŠ¶æ€ç®¡ç†å’Œç›‘æ§
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 1.1 åˆ›å»ºBatchTaskå®ä½“ [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/common/entity/BatchTask.java`
**ä¾èµ–**: `BaseEntity.java`, `BatchType.java`, `BatchTaskStatus.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] æ‰¹é‡ä»»åŠ¡åŸºç¡€å­—æ®µå®Œæ•´
- [x] ä»»åŠ¡çŠ¶æ€æšä¸¾æ”¯æŒæ‰€æœ‰ä¸šåŠ¡çŠ¶æ€
- [x] ä»»åŠ¡è¿›åº¦è·Ÿè¸ªå­—æ®µå‡†ç¡®
- [x] ä»»åŠ¡æ‰§è¡Œæ—¶é—´ç»Ÿè®¡å®Œæ•´
- [x] æŸ¥è¯¢ç´¢å¼•ä¼˜åŒ–é…ç½®

#### 1.2 åˆ›å»ºBatchTaskItemå®ä½“ [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/common/entity/BatchTaskItem.java`
**ä¾èµ–**: `BaseEntity.java`, `BatchTask.java`, `BatchItemStatus.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] ä»»åŠ¡é¡¹å­—æ®µæ”¯æŒå„ç§æ•°æ®ç±»å‹
- [x] åˆ†ç‰‡é”®æ”¯æŒåˆ†å¸ƒå¼å¤„ç†
- [x] é‡è¯•è®¡æ•°å’Œå¤„ç†æ—¶é—´è®°å½•
- [x] é”™è¯¯ä¿¡æ¯è®°å½•å®Œæ•´
- [x] ä¸ä¸»è¡¨å…³è”å…³ç³»æ­£ç¡®

#### 1.3 å®ç°BatchTaskOrchestrator [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/batch/BatchTaskOrchestrator.java`
**ä¾èµ–**: `BatchTaskRepository.java`, `ThreadPoolTaskExecutor.java`, `RedisTemplate.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] ä»»åŠ¡ç¼–æ’é€»è¾‘å®Œæ•´
- [x] åˆ†ç‰‡å¤„ç†ç­–ç•¥æ™ºèƒ½
- [x] å¼‚æ­¥æ‰§è¡Œæ€§èƒ½ä¼˜åŒ–
- [x] ä»»åŠ¡çŠ¶æ€åŒæ­¥å‡†ç¡®
- [x] å¼‚å¸¸æ¢å¤æœºåˆ¶æœ‰æ•ˆ

#### 1.4 å®ç°BatchProcessorFactory [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/batch/BatchProcessorFactory.java`
**ä¾èµ–**: `ApplicationContext.java`, `BatchProcessor.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] å¤„ç†å™¨æ³¨å†Œå’Œå‘ç°æœºåˆ¶
- [x] ç­–ç•¥æ¨¡å¼å®ç°å®Œæ•´
- [x] æ’ä»¶åŒ–æ‰©å±•æ”¯æŒ
- [x] å¤„ç†å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- [x] æ€§èƒ½ç›‘æ§å’Œç»Ÿè®¡

---

### ğŸ“¦ ä»»åŠ¡ 2: å•†å“æ‰¹é‡å¤„ç†å™¨ [x] [x]

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: å•†å“ä¸šåŠ¡å·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„å•†å“æ‰¹é‡å¤„ç†å™¨ï¼Œå®ç°å•†å“æ‰¹é‡ä¸Šä¸‹æ¶ã€æ‰¹é‡åˆ é™¤ã€ä»·æ ¼æ‰¹é‡è°ƒæ•´ç­‰åŠŸèƒ½ï¼Œç¡®ä¿æ‰¹é‡æ“ä½œçš„é«˜æ•ˆæ€§å’Œæ•°æ®ä¸€è‡´æ€§ã€‚
**Constraints**:
- å•†å“æ‰¹é‡æ“ä½œå¿…é¡»æ”¯æŒäº‹åŠ¡ä¸€è‡´æ€§
- æ‰¹é‡æ“ä½œä¸èƒ½å½±å“æ­£å¸¸å•†å“äº¤æ˜“
- å¤„ç†é”™è¯¯å¿…é¡»æ˜¯éƒ¨åˆ†å¤±è´¥çš„ï¼Œä¸å½±å“å…¶ä»–å•†å“å¤„ç†
- æ“ä½œå®Œæˆåå¿…é¡»ç¼“å­˜æ›´æ–°å’Œé€šçŸ¥å‘é€
- å¿…é¡»æ”¯æŒæ“ä½œå›æ»šå’Œæ’¤é”€åŠŸèƒ½
**_Leverage**: ç°æœ‰çš„GoodsRepositoryã€GoodsServiceã€AuditLogServiceã€CacheServiceã€FileStorageService
**_Requirements**: éœ€æ±‚74(å•†å“æ‰¹é‡ä¸Šä¸‹æ¶)ã€éœ€æ±‚75(ä»·æ ¼æ‰¹é‡è°ƒæ•´)ã€éœ€æ±‚76(åº“å­˜æ‰¹é‡æ›´æ–°)
**Success**:
- å•†å“æ‰¹é‡æ“ä½œåŠŸèƒ½å®Œæ•´æ­£ç¡®
- æ•°æ®ä¸€è‡´æ€§å¾—åˆ°ä¿è¯
- æ“ä½œæ€§èƒ½æ»¡è¶³è®¾è®¡è¦æ±‚
- é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶å®Œå–„
- ç¼“å­˜å’Œé€šçŸ¥é›†æˆæ­£å¸¸
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. ç¼–å†™å•†å“æ‰¹é‡æ“ä½œçš„å¤±è´¥æµ‹è¯•
2. å®ç°GoodsBatchProcessorå¤„ç†å™¨
3. å®ç°å•†å“æ‰¹é‡ä¸Šä¸‹æ¶åŠŸèƒ½
4. å®ç°ä»·æ ¼æ‰¹é‡è°ƒæ•´åŠŸèƒ½
5. å®ç°åº“å­˜æ‰¹é‡æ›´æ–°åŠŸèƒ½
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 2.1 åˆ›å»ºGoodsBatchRequest DTO [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/common/dto/request/GoodsBatchRequest.java`
**ä¾èµ–**: `BaseRequest.java`, `BatchOperationType.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] æ‰¹é‡è¯·æ±‚å­—æ®µå®Œæ•´
- [x] éªŒè¯æ³¨è§£é…ç½®æ­£ç¡®
- [x] åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ­£å¸¸
- [x] ä¸åŒæ“ä½œç±»å‹æ”¯æŒ

#### 2.2 å®ç°GoodsBatchProcessor [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/batch/processor/GoodsBatchProcessor.java`
**ä¾èµ–**: `BatchProcessor.java`, `GoodsRepository.java`, `GoodsService.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] æ‰¹é‡ä¸Šä¸‹æ¶åŠŸèƒ½å®ç°
- [x] æ‰¹é‡åˆ é™¤æœºåˆ¶å®Œå–„
- [x] å•†å“çŠ¶æ€éªŒè¯å‡†ç¡®
- [x] äº‹åŠ¡ç®¡ç†æ­£ç¡®
- [x] æ€§èƒ½ä¼˜åŒ–æœ‰æ•ˆ

#### 2.3 å®ç°PriceBatchProcessor [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/batch/processor/PriceBatchProcessor.java`
**ä¾èµ–**: `BatchProcessor.java`, `GoodsRepository.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] ä»·æ ¼è°ƒæ•´é€»è¾‘æ­£ç¡®
- [x] è°ƒä»·å¹…åº¦éªŒè¯æœ‰æ•ˆ
- [x] ä»·æ ¼å†å²è®°å½•ï¼ˆå®¡è®¡æ—¥å¿—ï¼‰
- [x] è°ƒä»·æŠ¥å‘Šç”Ÿæˆå‡†ç¡®
- [x] ç¼“å­˜é›†æˆæ­£å¸¸

#### 2.4 å®ç°InventoryBatchProcessor [x]
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/batch/processor/InventoryBatchProcessor.java`
**ä¾èµ–**: `BatchProcessor.java`, `GoodsRepository.java`
**éªŒæ”¶æ ‡å‡†**:
- [x] åº“å­˜æ•°æ®å¤„ç†æ­£ç¡®
- [x] åº“å­˜æ›´æ–°äº‹åŠ¡å®‰å…¨
- [x] é”™è¯¯å¤„ç†å’ŒéªŒè¯æœºåˆ¶
- [x] åº“å­˜çŠ¶æ€åŒæ­¥åŠæ—¶
- [x] æ•°æ®éªŒè¯ä¸¥æ ¼

---

### ğŸ“¦ ä»»åŠ¡ 3: ç”¨æˆ·é€šçŸ¥æ‰¹é‡å¤„ç†å™¨ [x]

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: é€šçŸ¥ç³»ç»Ÿå·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·é€šçŸ¥æ‰¹é‡å¤„ç†å™¨ï¼Œå®ç°ç”¨æˆ·ç­›é€‰ã€æ‰¹é‡æ¶ˆæ¯å‘é€ã€å‘é€ç»“æœè·Ÿè¸ªç­‰åŠŸèƒ½ï¼Œç¡®ä¿é€šçŸ¥çš„é«˜æ•ˆé€è¾¾å’Œå‡†ç¡®çš„ç»Ÿè®¡åˆ†æã€‚
**Constraints**:
- é€šçŸ¥æ‰¹é‡å‘é€å¿…é¡»æ”¯æŒå¤šç§æ¸ é“ï¼ˆçŸ­ä¿¡ã€é‚®ä»¶ã€ç«™å†…ä¿¡ï¼‰
- ç”¨æˆ·ç­›é€‰å¿…é¡»æ”¯æŒå¤æ‚æ¡ä»¶å’Œç»„åˆæŸ¥è¯¢
- å‘é€å¤±è´¥å¿…é¡»æ”¯æŒé‡è¯•å’Œé™çº§ç­–ç•¥
- å‘é€çŠ¶æ€å¿…é¡»å®æ—¶æ›´æ–°å’Œå¯æŸ¥è¯¢
- æ‰¹é‡å‘é€ä¸èƒ½å½±å“ç³»ç»Ÿæ€§èƒ½
**_Leverage**: ç°æœ‰çš„NotificationServiceã€UserServiceã€WebSocketManagerã€MessageQueueã€çŸ­ä¿¡ç½‘å…³ã€é‚®ä»¶æœåŠ¡
**_Requirements**: éœ€æ±‚77(æ‰¹é‡ç”¨æˆ·é€šçŸ¥)
**Success**:
- æ‰¹é‡é€šçŸ¥å‘é€åŠŸèƒ½å®Œæ•´å¯ç”¨
- ç”¨æˆ·ç­›é€‰ç²¾ç¡®ï¼Œæ¡ä»¶ç»„åˆçµæ´»
- å‘é€ç»“æœç»Ÿè®¡å‡†ç¡®
- å¤±è´¥é‡è¯•å’Œé™çº§æœºåˆ¶æœ‰æ•ˆ
- ç³»ç»Ÿæ€§èƒ½ç¨³å®šï¼Œæ— é˜»å¡
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. ç¼–å†™é€šçŸ¥æ‰¹é‡æ“ä½œçš„å¤±è´¥æµ‹è¯•
2. å®ç°NotificationBatchProcessorå¤„ç†å™¨
3. å®ç°ç”¨æˆ·ç­›é€‰å’Œè¿‡æ»¤é€»è¾‘
4. å®ç°å¤šæ¸ é“æ¶ˆæ¯å‘é€
5. å®ç°å‘é€çŠ¶æ€è·Ÿè¸ªå’Œç»Ÿè®¡
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 3.1 åˆ›å»ºNotificationBatchRequest DTO
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/common/dto/request/NotificationBatchRequest.java`
**ä¾èµ–**: `BaseRequest.java`, `NotificationChannel.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰¹é‡é€šçŸ¥è¯·æ±‚å­—æ®µå®Œæ•´
- [ ] ç”¨æˆ·ç­›é€‰æ¡ä»¶çµæ´»
- [ ] æ¶ˆæ¯æ¨¡æ¿æ”¯æŒå˜é‡æ›¿æ¢
- [ ] å‘é€é…ç½®å¯å®šåˆ¶

#### 3.2 å®ç°NotificationBatchProcessor
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/processor/notification/NotificationBatchProcessor.java`
**ä¾èµ–**: `BatchProcessor.java`, `NotificationService.java`, `UserService.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ç”¨æˆ·ç­›é€‰é€»è¾‘å‡†ç¡®
- [ ] å¤šæ¸ é“å‘é€åŠŸèƒ½å®Œæ•´
- [ ] æ¶ˆæ¯ä¸ªæ€§åŒ–æ­£ç¡®
- [ ] å‘é€çŠ¶æ€å®æ—¶æ›´æ–°
- [ ] å¼‚å¸¸å¤„ç†å’Œé‡è¯•æœºåˆ¶

#### 3.3 å®ç°BatchUserFilter
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/filter/BatchUserFilter.java`
**ä¾èµ–**: `UserRepository.java`, `JPA Criteria API`
**éªŒæ”¶æ ‡å‡†**:
- [ ] å¤šæ¡ä»¶ç”¨æˆ·ç­›é€‰
- [ ] ç»„åˆæŸ¥è¯¢æ”¯æŒ
- [ ] ç­›é€‰æ€§èƒ½ä¼˜åŒ–
- [ ] ç­›é€‰ç»“æœç¼“å­˜
- [ ] æƒé™æ£€æŸ¥é›†æˆ

#### 3.4 å®ç°BatchNotificationTracker
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/tracker/BatchNotificationTracker.java`
**ä¾èµ–**: `NotificationRepository.java`, `RedisTemplate.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] å‘é€çŠ¶æ€è¿½è¸ªå‡†ç¡®
- [ ] ç»Ÿè®¡æ•°æ®å®æ—¶æ›´æ–°
- [ ] å¤±è´¥åˆ†ææŠ¥å‘Šå®Œæ•´
- [ ] å‘é€æ€§èƒ½ç›‘æ§
- [ ] å‘Šè­¦æœºåˆ¶æœ‰æ•ˆ

---

### ğŸ“¦ ä»»åŠ¡ 4: æ‰¹é‡æ“ä½œç›‘æ§å’Œç»Ÿè®¡ [x]

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: ç›‘æ§ç³»ç»Ÿå·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„ç›‘æ§å’Œç»Ÿè®¡åŠŸèƒ½ï¼Œå®ç°ä»»åŠ¡è¿›åº¦è¿½è¸ªã€æ‰§è¡Œç»“æœåˆ†æã€æ€§èƒ½æŒ‡æ ‡æ”¶é›†ã€å¼‚å¸¸å‘Šè­¦ç­‰åŠŸèƒ½ï¼Œç¡®ä¿æ‰¹é‡æ“ä½œçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
**Constraints**:
- ç›‘æ§æ•°æ®æ”¶é›†ä¸èƒ½å½±å“æ‰¹é‡æ“ä½œæ€§èƒ½
- è¿›åº¦æ›´æ–°å¿…é¡»æ˜¯å®æ—¶çš„ï¼Œæ”¯æŒWebSocketæ¨é€
- ç»Ÿè®¡æŸ¥è¯¢å¿…é¡»æ”¯æŒå¤§æ•°æ®é‡å’Œå¤æ‚æ¡ä»¶
- å¼‚å¸¸å‘Šè­¦å¿…é¡»åŠæ—¶å‡†ç¡®
- ç›‘æ§æ•°æ®å¿…é¡»æ”¯æŒæŒä¹…åŒ–å’Œå†å²æŸ¥è¯¢
**_Leverage**: ç°æœ‰çš„ç›‘æ§ç³»ç»Ÿã€WebSocketManagerã€MeterRegistryã€Redisç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—
**_Requirements**: éœ€æ±‚78(æ‰¹é‡æ“ä½œç›‘æ§å’Œæ—¥å¿—)
**Success**:
- æ‰¹é‡æ“ä½œç›‘æ§å®Œæ•´å¯ç”¨
- è¿›åº¦æ¨é€åŠæ—¶å‡†ç¡®
- ç»Ÿè®¡åˆ†æåŠŸèƒ½å¼ºå¤§
- å¼‚å¸¸å‘Šè­¦æœºåˆ¶æœ‰æ•ˆ
- ç³»ç»Ÿå¯è§‚æµ‹æ€§è‰¯å¥½
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. ç¼–å†™ç›‘æ§ç»Ÿè®¡çš„å¤±è´¥æµ‹è¯•
2. å®ç°BatchMonitorServiceç›‘æ§æœåŠ¡
3. å®ç°å®æ—¶è¿›åº¦æ¨é€åŠŸèƒ½
4. å®ç°ç»Ÿè®¡åˆ†æå’ŒæŠ¥è¡¨åŠŸèƒ½
5. å®ç°å¼‚å¸¸å‘Šè­¦å’Œé€šçŸ¥
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 4.1 åˆ›å»ºBatchMonitorService
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/BatchMonitorService.java`
**ä¾èµ–**: `BatchTaskRepository.java`, `WebSocketManager.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ä»»åŠ¡çŠ¶æ€ç›‘æ§å®Œæ•´
- [ ] è¿›åº¦è®¡ç®—å‡†ç¡®
- [ ] å®æ—¶æ¨é€åŠæ—¶
- [ ] ç›‘æ§æ€§èƒ½ä¼˜åŒ–
- [ ] ç›‘æ§æ•°æ®å®‰å…¨

#### 4.2 å®ç°BatchMetricsCollector
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/monitor/BatchMetricsCollector.java`
**ä¾èµ–**: `MeterRegistry.java`, `BatchTaskOrchestrator.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æ€§èƒ½æŒ‡æ ‡æ”¶é›†å®Œæ•´
- [ ] ä¸šåŠ¡æŒ‡æ ‡ç»Ÿè®¡å‡†ç¡®
- [ ] æŒ‡æ ‡å­˜å‚¨å’ŒæŸ¥è¯¢é«˜æ•ˆ
- [ ] å‘Šè­¦é˜ˆå€¼é…ç½®çµæ´»
- [ ] æŒ‡æ ‡å±•ç¤ºç›´è§‚

#### 4.3 å®ç°BatchAlertManager
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/alert/BatchAlertManager.java`
**ä¾èµ–**: `AlertService.java`, `NotificationService.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] å¼‚å¸¸æ£€æµ‹åŠæ—¶
- [ ] å‘Šè­¦è§„åˆ™çµæ´»
- [ ] å‘Šè­¦é€è¾¾ç‡é«˜
- [ ] å‘Šè­¦æ¢å¤åŠæ—¶
- [ ] å‘Šè­¦å™ªéŸ³æ§åˆ¶

#### 4.4 å®ç°BatchStatisticsService
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/BatchStatisticsService.java`
**ä¾èµ–**: `BatchTaskRepository.java`, `JdbcTemplate.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ç»Ÿè®¡æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
- [ ] å¤šç»´åº¦ç»Ÿè®¡åˆ†æ
- [ ] æŠ¥è¡¨ç”Ÿæˆå‡†ç¡®
- [ ] å†å²æ•°æ®æŸ¥è¯¢
- [ ] ç»Ÿè®¡æ•°æ®ç¼“å­˜

---

### ğŸ“¦ ä»»åŠ¡ 5: æ‰¹é‡æ“ä½œæƒé™æ§åˆ¶ [x]

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: æƒé™ç³»ç»Ÿå·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„æƒé™æ§åˆ¶åŠŸèƒ½ï¼Œå®ç°æ“ä½œæƒé™éªŒè¯ã€æ‰¹é‡æ•°é‡é™åˆ¶ã€ç”¨æˆ·åˆ†çº§ç®¡ç†ã€å®‰å…¨å®¡è®¡ç­‰åŠŸèƒ½ï¼Œç¡®ä¿æ‰¹é‡æ“ä½œçš„å®‰å…¨æ€§å’Œåˆè§„æ€§ã€‚
**Constraints**:
- æƒé™éªŒè¯å¿…é¡»é«˜æ•ˆï¼Œä¸èƒ½å½±å“æ‰¹é‡æ“ä½œæ€§èƒ½
- æ‰¹é‡æ•°é‡é™åˆ¶å¿…é¡»åŒºåˆ†ç”¨æˆ·çº§åˆ«
- æƒé™æ£€æŸ¥å¿…é¡»æ”¯æŒç»†ç²’åº¦æ§åˆ¶
- æ“ä½œå®¡è®¡å¿…é¡»å®Œæ•´è®°å½•
- å¼‚å¸¸æ“ä½œå¿…é¡»åŠæ—¶æ‹¦æˆª
**_Leverage**: ç°æœ‰çš„PermissionServiceã€SecurityUtilã€AuditLogServiceã€æƒé™ç¼–ç å®šä¹‰ã€ç”¨æˆ·è§’è‰²ç³»ç»Ÿ
**_Requirements**: éœ€æ±‚79(æ‰¹é‡æ“ä½œæƒé™æ§åˆ¶)
**Success**:
- æƒé™æ§åˆ¶æœºåˆ¶å®Œå–„æœ‰æ•ˆ
- ç”¨æˆ·åˆ†çº§ç®¡ç†åˆç†
- æ“ä½œå®¡è®¡è®°å½•å®Œæ•´
- å®‰å…¨é˜²æŠ¤æªæ–½åˆ°ä½
- æƒé™ç®¡ç†æ˜“äºæ‰©å±•
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. ç¼–å†™æƒé™æ§åˆ¶çš„å¤±è´¥æµ‹è¯•
2. å®ç°BatchPermissionServiceæƒé™æœåŠ¡
3. å®ç°æ‰¹é‡æ•°é‡é™åˆ¶æœºåˆ¶
4. å®ç°æ“ä½œæƒé™éªŒè¯
5. å®ç°æ“ä½œå®¡è®¡å’Œå®‰å…¨æ§åˆ¶
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 5.1 åˆ›å»ºBatchPermissionService
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/BatchPermissionService.java`
**ä¾èµ–**: `PermissionService.java`, `UserService.java`, `RoleDefinition.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æƒé™éªŒè¯é€»è¾‘å‡†ç¡®
- [ ] ç”¨æˆ·çº§åˆ«åˆ¤æ–­æ­£ç¡®
- [ ] æ“ä½œæƒé™æ£€æŸ¥ä¸¥æ ¼
- [ ] æƒé™éªŒè¯æ€§èƒ½ä¼˜åŒ–
- [ ] æƒé™é…ç½®çµæ´»

#### 5.2 å®ç°BatchRateLimiter
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/security/BatchRateLimiter.java`
**ä¾èµ–**: `Guava RateLimiter.java`, `RedisTemplate.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] é™æµç­–ç•¥åˆç†
- [ ] ç”¨æˆ·åŒºåˆ†å‡†ç¡®
- [ ] é™æµæ€§èƒ½é«˜æ•ˆ
- [ ] é™æµå‘Šè­¦åŠæ—¶
- [ ] é™æµé…ç½®å¯è°ƒæ•´

#### 5.3 å®ç°BatchSecurityValidator
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/validator/BatchSecurityValidator.java`
**ä¾èµ–**: `FileValidator.java`, `SQLInjectionChecker.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] è¾“å…¥éªŒè¯ä¸¥æ ¼
- [ ] SQLæ³¨å…¥é˜²æŠ¤
- [ ] XSSæ”»å‡»é˜²æŠ¤
- [ ] æ–‡ä»¶å®‰å…¨æ£€æŸ¥
- [ ] æ¶æ„æ“ä½œæ‹¦æˆª

#### 5.4 å®ç°BatchAuditService
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/service/BatchAuditService.java`
**ä¾èµ–**: `AuditLogService.java`, `BatchTaskRepository.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æ“ä½œå®¡è®¡è®°å½•å®Œæ•´
- [ ] å®¡è®¡æ•°æ®ç»“æ„åŒ–
- [ ] å®¡è®¡æŸ¥è¯¢é«˜æ•ˆ
- [ ] å®¡è®¡æŠ¥è¡¨ç”Ÿæˆ
- [ ] å®¡è®¡æ•°æ®å®‰å…¨

---

### ğŸ“¦ ä»»åŠ¡ 6: æ‰¹é‡æ“ä½œæ§åˆ¶å™¨å’ŒAPI [x]

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: APIæ¶æ„å·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„æ§åˆ¶å™¨å’ŒAPIæ¥å£ï¼Œå®ç°ç”¨æˆ·ç«¯æ‰¹é‡æ“ä½œAPIã€ç®¡ç†å‘˜ç«¯ç®¡ç†APIã€ä»»åŠ¡æŸ¥è¯¢APIã€è¿›åº¦è·Ÿè¸ªAPIç­‰åŠŸèƒ½ï¼Œç¡®ä¿APIçš„è§„èŒƒæ€§å’Œæ˜“ç”¨æ€§ã€‚
**Constraints**:
- APIè®¾è®¡å¿…é¡»éµå¾ªRESTfulè§„èŒƒ
- å‚æ•°éªŒè¯å¿…é¡»ä¸¥æ ¼ï¼Œé”™è¯¯ä¿¡æ¯å‹å¥½
- APIå“åº”å¿…é¡»ç»Ÿä¸€æ ¼å¼ï¼Œæ”¯æŒåˆ†é¡µ
- å¼‚å¸¸å¤„ç†å¿…é¡»å…¨å±€ç»Ÿä¸€
- APIæ–‡æ¡£å¿…é¡»å®Œæ•´ä¸”å¯è°ƒè¯•
**_Leverage**: ç°æœ‰çš„BaseControllerã€å…¨å±€å¼‚å¸¸å¤„ç†ã€æƒé™éªŒè¯ã€APIæ–‡æ¡£ç³»ç»Ÿã€åˆ†é¡µæ”¯æŒ
**_Requirements**: éœ€æ±‚74(å•†å“æ‰¹é‡ä¸Šä¸‹æ¶)ã€éœ€æ±‚75(ä»·æ ¼æ‰¹é‡è°ƒæ•´)ã€éœ€æ±‚76(åº“å­˜æ‰¹é‡æ›´æ–°)ã€éœ€æ±‚77(æ‰¹é‡ç”¨æˆ·é€šçŸ¥)
**Success**:
- æ‰€æœ‰APIæ¥å£åŠŸèƒ½æ­£å¸¸
- å‚æ•°éªŒè¯å’Œæƒé™æ£€æŸ¥æœ‰æ•ˆ
- APIå“åº”æ ¼å¼ç»Ÿä¸€è§„èŒƒ
- é”™è¯¯å¤„ç†å®Œå–„å‹å¥½
- APIæ–‡æ¡£å®Œæ•´å¯ç”¨
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. ç¼–å†™APIæ¥å£çš„å¤±è´¥æµ‹è¯•
2. å®ç°BatchOperationControllerç”¨æˆ·API
3. å®ç°BatchAdminControllerç®¡ç†API
4. å®ç°BatchMonitorControllerç›‘æ§API
5. é…ç½®APIå®‰å…¨å’ŒéªŒè¯
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 6.1 åˆ›å»ºæ‰¹é‡è¯·æ±‚å“åº”DTO
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/common/dto/response/BatchOperationResponse.java`
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/common/dto/response/BatchTaskResponse.java`
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/common/dto/response/BatchTaskProgressResponse.java`
**ä¾èµ–**: `BaseResponse.java`, `BatchOperationResult.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰¹é‡æ“ä½œå“åº”ç»“æ„å®Œæ•´
- [ ] ä»»åŠ¡æŸ¥è¯¢å“åº”æ ¼å¼æ­£ç¡®
- [ ] è¿›åº¦ä¿¡æ¯æ¨é€åŠæ—¶
- [ ] é”™è¯¯ä¿¡æ¯åˆ†ç±»æ¸…æ™°
- [ ] æ•°æ®åºåˆ—åŒ–æ­£å¸¸

#### 6.2 å®ç°BatchOperationController
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/controller/BatchOperationController.java`
**ä¾èµ–**: `BatchOperationService.java`, `BaseController.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] å•†å“æ‰¹é‡æ“ä½œAPIå®Œæ•´
- [ ] å‚æ•°éªŒè¯ä¸¥æ ¼æœ‰æ•ˆ
- [ ] æƒé™æ£€æŸ¥å‡†ç¡®
- [ ] é”™è¯¯å¤„ç†å‹å¥½
- [ ] APIæ–‡æ¡£å®Œæ•´

#### 6.3 å®ç°BatchAdminController
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/controller/BatchAdminController.java`
**ä¾èµ–**: `BatchAdminService.java`, `BaseController.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ç®¡ç†å‘˜APIåŠŸèƒ½å®Œæ•´
- [ ] ç®¡ç†æ“ä½œæƒé™éªŒè¯
- [ ] ä»»åŠ¡ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] ç»Ÿè®¡æŸ¥è¯¢é«˜æ•ˆ
- [ ] æ“ä½œå®¡è®¡è®°å½•

#### 6.4 å®ç°BatchMonitorController
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/controller/BatchMonitorController.java`
**ä¾èµ–**: `BatchMonitorService.java`, `WebSocketController.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ç›‘æ§APIåŠŸèƒ½å®Œæ•´
- [ ] è¿›åº¦æŸ¥è¯¢å®æ—¶å‡†ç¡®
- [ ] WebSocketæ¨é€ç¨³å®š
- [ ] ç»Ÿè®¡æ•°æ®å‡†ç¡®
- [ ] å‘Šè­¦æ¥å£æœ‰æ•ˆ

---

### ğŸ“¦ ä»»åŠ¡ 7: æ‰¹é‡æ“ä½œé…ç½®å’Œæ€§èƒ½ä¼˜åŒ– [x]

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: æ€§èƒ½ä¼˜åŒ–å·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„é…ç½®å’Œæ€§èƒ½ä¼˜åŒ–åŠŸèƒ½ï¼ŒåŒ…æ‹¬çº¿ç¨‹æ± é…ç½®ã€åˆ†ç‰‡ç­–ç•¥ä¼˜åŒ–ã€ç¼“å­˜é…ç½®ã€æ•°æ®åº“ä¼˜åŒ–ç­‰åŠŸèƒ½ï¼Œç¡®ä¿æ‰¹é‡æ“ä½œçš„é«˜æ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚
**Constraints**:
- é…ç½®å¿…é¡»æ”¯æŒå¤šç¯å¢ƒåŠ¨æ€è°ƒæ•´
- æ€§èƒ½ä¼˜åŒ–ä¸èƒ½å½±å“åŠŸèƒ½æ­£ç¡®æ€§
- çº¿ç¨‹æ± é…ç½®å¿…é¡»åˆç†å¯æ§
- åˆ†ç‰‡ç­–ç•¥å¿…é¡»æ”¯æŒè‡ªåŠ¨è°ƒæ•´
- ä¼˜åŒ–æ•ˆæœå¿…é¡»å¯æµ‹é‡
**_Leverage**: ç°æœ‰çš„é…ç½®ç®¡ç†ç³»ç»Ÿã€ç¼“å­˜ç³»ç»Ÿã€æ•°æ®åº“è¿æ¥æ± ã€æ€§èƒ½æµ‹è¯•å·¥å…·ã€ç›‘æ§ç³»ç»Ÿ
**_Requirements**: æ‰€æœ‰æ‰¹é‡æ“ä½œéƒ½éœ€è¦æ€§èƒ½ä¼˜åŒ–
**Success**:
- æ‰¹é‡æ“ä½œæ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
- ç³»ç»Ÿèµ„æºåˆ©ç”¨ç‡åˆç†
- é…ç½®ç®¡ç†çµæ´»æ˜“ç”¨
- ä¼˜åŒ–æ•ˆæœå¯è§‚æµ‹
- ç³»ç»Ÿå¯æ‰©å±•æ€§è‰¯å¥½
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. ç¼–å†™æ€§èƒ½æµ‹è¯•åŸºå‡†
2. ä¼˜åŒ–çº¿ç¨‹æ± å’Œåˆ†ç‰‡é…ç½®
3. å®ç°ç¼“å­˜ç­–ç•¥
4. ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
5. é›†æˆæ€§èƒ½ç›‘æ§
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 7.1 åˆ›å»ºæ‰¹é‡æ“ä½œé…ç½®
**æ–‡ä»¶**: `backend/src/main/resources/application-batch.yml`
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/config/BatchConfiguration.java`
**ä¾èµ–**: `ConfigurationProperties.java`, `ThreadPoolTaskExecutor.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] é…ç½®é¡¹å®Œæ•´å‡†ç¡®
- [ ] å¤šç¯å¢ƒæ”¯æŒ
- [ ] é…ç½®éªŒè¯æœ‰æ•ˆ
- [ ] é»˜è®¤å€¼åˆç†
- [ ] é…ç½®æ–‡æ¡£å®Œæ•´

#### 7.2 ä¼˜åŒ–åˆ†ç‰‡ç­–ç•¥
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/strategy/SmartShardStrategy.java`
**ä¾èµ–**: `BatchTaskSizeCalculator.java`, `ResourceMonitor.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] åˆ†ç‰‡è®¡ç®—å‡†ç¡®
- [ ] è‡ªé€‚åº”è°ƒæ•´æœ‰æ•ˆ
- [ ] èµ„æºåˆ©ç”¨ä¼˜åŒ–
- [ ] æ€§èƒ½æå‡æ˜æ˜¾
- [ ] ç­–ç•¥é…ç½®çµæ´»

#### 7.3 é…ç½®ç¼“å­˜ç­–ç•¥
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/cache/BatchCacheManager.java`
**ä¾èµ–**: `RedisTemplate.java`, `CacheConfiguration.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ç¼“å­˜ç­–ç•¥åˆç†
- [ ] ç¼“å­˜å‘½ä¸­ç‡è¾¾æ ‡
- [ ] ç¼“å­˜ä¸€è‡´æ€§ä¿è¯
- [ ] ç¼“å­˜æ€§èƒ½ä¼˜åŒ–
- [ ] ç¼“å­˜ç›‘æ§å®Œå–„

#### 7.4 ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
**æ–‡ä»¶**: `backend/src/main/java/com/campus/marketplace/repository/impl/BatchTaskRepositoryImpl.java`
**ä¾èµ–**: `EntityManager.java`, `JPA Criteria API`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
- [ ] N+1æŸ¥è¯¢é—®é¢˜è§£å†³
- [ ] æ‰¹é‡æ“ä½œä¼˜åŒ–
- [ ] æŸ¥è¯¢ç¼“å­˜é›†æˆ
- [ ] æŸ¥è¯¢ç›‘æ§å®Œå¤‡

---

### ğŸ“¦ ä»»åŠ¡ 8: æ‰¹é‡æ“ä½œæµ‹è¯•å’Œè´¨é‡ä¿è¯

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: æµ‹è¯•è´¨é‡å·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„æµ‹è¯•å’Œè´¨é‡ä¿è¯åŠŸèƒ½ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ã€å‹åŠ›æµ‹è¯•ç­‰åŠŸèƒ½ï¼Œç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚
**Constraints**:
- æµ‹è¯•è¦†ç›–ç‡å¿…é¡»â‰¥85%
- æ€§èƒ½æµ‹è¯•å¿…é¡»æ»¡è¶³è®¾è®¡æŒ‡æ ‡
- é›†æˆæµ‹è¯•å¿…é¡»è¦†ç›–ä¸»è¦æµç¨‹
- æµ‹è¯•ç¯å¢ƒå¿…é¡»å¯é‡å¤ä½¿ç”¨
- æµ‹è¯•æŠ¥å‘Šå¿…é¡»å®Œæ•´å‡†ç¡®
**_Leverage**: ç°æœ‰çš„æµ‹è¯•æ¡†æ¶ã€æ€§èƒ½æµ‹è¯•å·¥å…·ã€æµ‹è¯•æ•°æ®ç®¡ç†ã€æŒç»­é›†æˆç³»ç»Ÿ
**_Requirements**: è¦†ç›–æ‰€æœ‰æ‰¹é‡æ“ä½œåŠŸèƒ½çš„æµ‹è¯•
**Success**:
- æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- æµ‹è¯•è¦†ç›–ç‡è¾¾æ ‡
- æ€§èƒ½æŒ‡æ ‡æ»¡è¶³è¦æ±‚
- æµ‹è¯•æ–‡æ¡£å®Œæ•´
- è´¨é‡é—¨ç¦æœ‰æ•ˆ
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. è®¾è®¡æµ‹è¯•ç­–ç•¥å’Œç”¨ä¾‹
2. å®ç°å•å…ƒæµ‹è¯•
3. å®ç°é›†æˆæµ‹è¯•
4. å®ç°æ€§èƒ½æµ‹è¯•
5. é…ç½®è´¨é‡é—¨ç¦
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 8.1 åˆ›å»ºå•å…ƒæµ‹è¯•å¥—ä»¶
**æ–‡ä»¶**: `backend/src/test/java/com/campus/marketplace/service/BatchOperationServiceTest.java`
**æ–‡ä»¶**: `backend/src/test/java/com/campus/marketplace/processor/GoodsBatchProcessorTest.java`
**ä¾èµ–**: `JUnit5.java`, `Mockito.java`, `Spring Boot Test`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æµ‹è¯•å®Œæ•´
- [ ] è¾¹ç•Œæ¡ä»¶æµ‹è¯•è¦†ç›–
- [ ] å¼‚å¸¸å¤„ç†æµ‹è¯•æœ‰æ•ˆ
- [ ] æµ‹è¯•æ•°æ®ç®¡ç†è§„èŒƒ
- [ ] æµ‹è¯•æ‰§è¡Œæ•ˆç‡é«˜

#### 8.2 åˆ›å»ºé›†æˆæµ‹è¯•å¥—ä»¶
**æ–‡ä»¶**: `backend/src/test/java/com/campus/marketplace/integration/BatchOperationIntegrationTest.java`
**æ–‡ä»¶**: `backend/src/test/java/com/campus/marketplace/integration/BatchControllerTest.java`
**ä¾èµ–**: `@SpringBootTest.java`, `TestContainers.java`, `MockMvc.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] APIé›†æˆæµ‹è¯•å®Œæ•´
- [ ] æ•°æ®åº“é›†æˆç¨³å®š
- [ ] äº‹åŠ¡æµ‹è¯•æœ‰æ•ˆ
- [ ] å¼‚å¸¸åœºæ™¯è¦†ç›–
- [ ] æµ‹è¯•ç¯å¢ƒéš”ç¦»

#### 8.3 åˆ›å»ºæ€§èƒ½æµ‹è¯•å¥—ä»¶
**æ–‡ä»¶**: `backend/src/test/java/com/campus/marketplace/performance/BatchOperationPerformanceTest.java`
**æ–‡ä»¶**: `backend/src/test/java/com/campus/marketplace/performance/BatchConcurrencyTest.java`
**ä¾èµ–**: `JMH.java`, `Gatling.java`, `æ€§èƒ½ç›‘æ§å·¥å…·`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•å‡†ç¡®
- [ ] å¹¶å‘æµ‹è¯•ç¨³å®šæ€§
- [ ] èµ„æºä½¿ç”¨ç›‘æ§
- [ ] æ€§èƒ½å›å½’æ£€æµ‹
- [ ] æ€§èƒ½æŠ¥å‘Šå®Œæ•´

#### 8.4 é…ç½®è´¨é‡é—¨ç¦
**æ–‡ä»¶**: `backend/scripts/quality-gate-check.sh`
**ä¾èµ–**: `JUnit.java`, `Jacoco.java`, `SonarQube.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ä»£ç è¦†ç›–ç‡æ£€æŸ¥
- [ ] è´¨é‡æŒ‡æ ‡æ£€æŸ¥
- [ ] æ€§èƒ½æŒ‡æ ‡æ£€æŸ¥
- [ ] å®‰å…¨æ‰«ææ£€æŸ¥
- [ ] å‘Šè­¦æœºåˆ¶æœ‰æ•ˆ

---

### ğŸ“¦ ä»»åŠ¡ 9: æ‰¹é‡æ“ä½œéƒ¨ç½²å’Œè¿ç»´

**_Prompt**: Implement the task for spec batch-operation-system, first run spec-workflow-guide to get the workflow guide then implement the task:
```text
**Role**: DevOpså·¥ç¨‹å¸ˆ
**Task**: å¼€å‘æ‰¹é‡æ“ä½œç³»ç»Ÿçš„éƒ¨ç½²å’Œè¿ç»´åŠŸèƒ½ï¼ŒåŒ…æ‹¬å®¹å™¨åŒ–éƒ¨ç½²ã€é…ç½®ç®¡ç†ã€ç›‘æ§å‘Šè­¦ã€æ—¥å¿—æ”¶é›†ã€æ•…éšœæ¢å¤ç­‰åŠŸèƒ½ï¼Œç¡®ä¿ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯éƒ¨ç½²æ€§ã€‚
**Constraints**:
- éƒ¨ç½²å¿…é¡»æ”¯æŒå¤šç¯å¢ƒ
- ç›‘æ§å¿…é¡»è¦†ç›–å…³é”®æŒ‡æ ‡
- æ—¥å¿—å¿…é¡»é›†ä¸­ç®¡ç†
- æ•…éšœæ¢å¤å¿…é¡»è‡ªåŠ¨åŒ–
- è¿ç»´æ–‡æ¡£å¿…é¡»å®Œæ•´
**_Leverage**: ç°æœ‰çš„Dockeré…ç½®ã€Kubernetesé…ç½®ã€ç›‘æ§ç³»ç»Ÿã€æ—¥å¿—ç³»ç»Ÿã€è¿ç»´è„šæœ¬
**_Requirements**: æ”¯æŒç³»ç»Ÿç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å’Œè¿ç»´
**Success**:
- éƒ¨ç½²æµç¨‹è‡ªåŠ¨åŒ–ç¨³å®š
- ç›‘æ§å‘Šè­¦åŠæ—¶æœ‰æ•ˆ
- æ—¥å¿—æ”¶é›†åˆ†æå®Œå–„
- æ•…éšœå¤„ç†å¿«é€Ÿå“åº”
- è¿ç»´æ–‡æ¡£è¯¦ç»†å‡†ç¡®
**Instructions**: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®æ–½ï¼š
1. è®¾è®¡éƒ¨ç½²æ¶æ„
2. åˆ›å»ºå®¹å™¨åŒ–é…ç½®
3. é…ç½®ç›‘æ§å‘Šè­¦
4. è®¾ç½®æ—¥å¿—æ”¶é›†
5. å‡†å¤‡è¿ç»´æ–‡æ¡£
6. åœ¨tasks.mdä¸­å°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º[-]è¿›è¡Œä¸­ï¼Œå®Œæˆåæ ‡è®°ä¸º[x]
```

#### 9.1 åˆ›å»ºDockeré…ç½®
**æ–‡ä»¶**: `docker/batch/Dockerfile`
**æ–‡ä»¶**: `docker/batch/docker-compose.yml`
**ä¾èµ–**: `OpenJDK.java`, `Spring Boot.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] Dockerfileä¼˜åŒ–åˆç†
- [ ] é•œåƒå¤§å°æ§åˆ¶ä¼˜ç§€
- [ ] å®‰å…¨é…ç½®ä¸¥æ ¼
- [ ] å¯åŠ¨é€Ÿåº¦è¾ƒå¿«
- [ ] å¥åº·æ£€æŸ¥å®Œå–„

#### 9.2 åˆ›å»ºKubernetesé…ç½®
**æ–‡ä»¶**: `k8s/batch/deployment.yaml`
**æ–‡ä»¶**: `k8s/batch/service.yaml`
**æ–‡ä»¶**: `k8s/batch/ingress.yaml`
**ä¾èµ–**: `Kubernetes API`
**éªŒæ”¶æ ‡å‡†**:
- [ ] èµ„æºé…ç½®åˆç†
- [ ] å¥åº·æ£€æŸ¥æœ‰æ•ˆ
- [ ] æœåŠ¡å‘ç°æ­£å¸¸
- [ ] ç½‘ç»œç­–ç•¥å®‰å…¨
- [ ] æ‰©ç¼©å®¹æ”¯æŒ

#### 9.3 é…ç½®ç›‘æ§å’Œå‘Šè­¦
**æ–‡ä»¶**: `monitoring/batch/prometheus.yml`
**æ–‡ä»¶**: `monitoring/batch/grafana-dashboard.json`
**ä¾èµ–**: `Prometheus.java`, `Grafana.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] ç›‘æ§æŒ‡æ ‡å®Œæ•´
- [ ] å‘Šè­¦è§„åˆ™åˆç†
- [ ] ä»ªè¡¨æ¿ç›´è§‚
- [ ] æ•°æ®æ”¶é›†ç¨³å®š
- [ ] å‘Šè­¦é€šçŸ¥åŠæ—¶

#### 9.4 è®¾ç½®æ—¥å¿—æ”¶é›†
**æ–‡ä»¶**: `logging/batch/logback-spring.xml`
**æ–‡ä»¶**: `logging/batch/fluentd.conf`
**ä¾èµ–**: `Logback.java`, `ELK Stack.java`
**éªŒæ”¶æ ‡å‡†**:
- [ ] æ—¥å¿—æ ¼å¼ç»Ÿä¸€è§„èŒƒ
- [ ] æ—¥å¿—çº§åˆ«é…ç½®åˆç†
- [ ] æ—¥å¿—æ”¶é›†å®Œæ•´
- [ ] æ—¥å¿—æŸ¥è¯¢ä¾¿æ·
- [ ] æ—¥å¿—å½’æ¡£æœ‰æ•ˆ

#### 9.5 åˆ›å»ºè¿ç»´æ–‡æ¡£
**æ–‡ä»¶**: `docs/ops/batch-deployment-guide.md`
**æ–‡ä»¶**: `docs/ops/batch-troubleshooting-guide.md`
**éªŒæ”¶æ ‡å‡†**:
- [ ] éƒ¨ç½²æŒ‡å—è¯¦ç»†å‡†ç¡®
- [ ] è¿ç»´æ‰‹å†Œå®ç”¨å®Œæ•´
- [ ] æ•…éšœå¤„ç†åŠæ—¶æœ‰æ•ˆ
- [ ] æ€§èƒ½è°ƒä¼˜æŒ‡å¯¼
- [ ] å®‰å…¨é…ç½®è§„èŒƒ

---

## ä»»åŠ¡ä¾èµ–å…³ç³»

```mermaid
gantt
    title æ‰¹é‡æ“ä½œç³»ç»Ÿå¼€å‘æ—¶é—´çº¿
    dateFormat  YYYY-MM-DD
    section æ ¸å¿ƒæ¶æ„
    ä»»åŠ¡1ï¼šæ‰¹é‡ä»»åŠ¡æ ¸å¿ƒæ¶æ„     :done, task1, 2025-11-04, 2d
    section ä¸šåŠ¡å¤„ç†
    ä»»åŠ¡2ï¼šå•†å“æ‰¹é‡å¤„ç†å™¨       :active, task2, after task1, 3d
    section é€šçŸ¥ç³»ç»Ÿ
    ä»»åŠ¡3ï¼šç”¨æˆ·é€šçŸ¥æ‰¹é‡å¤„ç†å™¨   :task3, after task1, 2d
    section ç›‘æ§ç»Ÿè®¡
    ä»»åŠ¡4ï¼šæ‰¹é‡æ“ä½œç›‘æ§ç»Ÿè®¡    :task4, after task2, 2d
    section æƒé™æ§åˆ¶
    ä»»åŠ¡5ï¼šæ‰¹é‡æ“ä½œæƒé™æ§åˆ¶    :task5, after task1, 2d
    section APIæ¥å£
    ä»»åŠ¡6ï¼šæ§åˆ¶å™¨å’ŒAPI         :task6, after task2, 2d
    section æ€§èƒ½ä¼˜åŒ–
    ä»»åŠ¡7ï¼šé…ç½®å’Œæ€§èƒ½ä¼˜åŒ–     :task7, after task6, 2d
    section è´¨é‡ä¿è¯
    ä»»åŠ¡8ï¼šæµ‹è¯•å’Œè´¨é‡ä¿è¯     :task8, after task7, 3d
    section è¿ç»´éƒ¨ç½²
    ä»»åŠ¡9ï¼šéƒ¨ç½²å’Œè¿ç»´         :task9, after task8, 2d
```

## è´¨é‡æ£€æŸ¥æ¸…å•

### æ¶æ„è®¾è®¡æ£€æŸ¥
- [ ] **ç¬¬0æ­¥å¤ç”¨æ£€æŸ¥**: å¤ç”¨ç°æœ‰æ¶æ„ç»„ä»¶ï¼Œé¿å…é‡å¤åˆ›å»º
- [ ] **ç¬¬1æ­¥æµ‹è¯•å…ˆè¡Œ**: æ ¸å¿ƒç»„ä»¶å…ˆå†™æµ‹è¯•ç”¨ä¾‹
- [ ] **åˆ†ç‰‡ç­–ç•¥**: å¤§æ‰¹é‡æ•°æ®ä½¿ç”¨åˆç†åˆ†ç‰‡ç®—æ³•
- [ ] **å¼‚æ­¥å¤„ç†**: ä½¿ç”¨Springå¼‚æ­¥æœºåˆ¶ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹
- [ ] **äº‹åŠ¡ç®¡ç†**: æ‰¹é‡æ“ä½œä½¿ç”¨é€‚å½“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«

### æ€§èƒ½ä¼˜åŒ–æ£€æŸ¥
- [ ] **çº¿ç¨‹æ± é…ç½®**: æ ¹æ®ç³»ç»Ÿèµ„æºåˆç†é…ç½®çº¿ç¨‹æ± å‚æ•°
- [ ] **ç¼“å­˜ç­–ç•¥**: çƒ­ç‚¹æ•°æ®ç¼“å­˜ï¼Œå‘½ä¸­ç‡â‰¥80%
- [ ] **æ•°æ®åº“ä¼˜åŒ–**: æ‰¹é‡SQLæ“ä½œï¼Œå‡å°‘æ•°æ®åº“äº¤äº’
- [ **å†…å­˜ç®¡ç†**:å¤§æ‰¹é‡æ•°æ®å¤„ç†é¿å…OOMï¼Œä½¿ç”¨æµå¼å¤„ç†
- [ ] **ç›‘æ§æŒ‡æ ‡**: å…³é”®æ€§èƒ½æŒ‡æ ‡å®æ—¶ç›‘æ§

### å®‰å…¨æ€§æ£€æŸ¥
- [ ] **æƒé™éªŒè¯**: ä¸¥æ ¼æ£€æŸ¥æ‰¹é‡æ“ä½œæƒé™
- [ ] **æ•°é‡é™åˆ¶**: æ ¹æ®ç”¨æˆ·çº§åˆ«é™åˆ¶æ‰¹é‡æ“ä½œæ•°é‡
- [ ] **å®‰å…¨å®¡è®¡**: è®°å½•æ‰€æœ‰æ‰¹é‡æ“ä½œæ—¥å¿—
- [ ] **è¾“å…¥éªŒè¯**: ä¸¥æ ¼éªŒè¯æ‰¹é‡æ“ä½œè¾“å…¥å‚æ•°
- [ ] **é˜²æ”»å‡»**: å®æ–½é™æµå’Œé˜²çˆ¬è™«æœºåˆ¶

### å¯é æ€§æ£€æŸ¥
- [ ] **å®¹é”™å¤„ç†**: éƒ¨åˆ†å¤±è´¥ä¸å½±å“æ•´ä½“ä»»åŠ¡
- [ ] **é‡è¯•æœºåˆ¶**: ä¸´æ—¶æ•…éšœè‡ªåŠ¨é‡è¯•
- [ ] **çŠ¶æ€ç®¡ç†**: ä»»åŠ¡çŠ¶æ€å‡†ç¡®è®°å½•å’Œæ¢å¤
- [ ] **å¼‚å¸¸æ¢å¤**: ç³»ç»Ÿæ•…éšœåä»»åŠ¡è‡ªåŠ¨æ¢å¤
- [ ] **æ•°æ®ä¸€è‡´**: æ‰¹é‡æ“ä½œæ•°æ®ä¸€è‡´æ€§ä¿éšœ

### å¯ç»´æŠ¤æ€§æ£€æŸ¥
- [ ] **é…ç½®ç®¡ç†**: æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼Œé…ç½®çƒ­æ›´æ–°
- [ ] **æ—¥å¿—è§„èŒƒ**: æ—¥å¿—æ ¼å¼ç»Ÿä¸€ï¼ŒåŒ…å«å…³é”®ä¸Šä¸‹æ–‡ä¿¡æ¯
- [ ] **ç›‘æ§å‘Šè­¦**: å…³é”®æŒ‡æ ‡ç›‘æ§ï¼ŒåŠæ—¶å‘Šè­¦é€šçŸ¥
- [ ] **æ–‡æ¡£é½å…¨**: è®¾è®¡æ–‡æ¡£ã€APIæ–‡æ¡£ã€è¿ç»´æ–‡æ¡£å®Œæ•´
- [ ] **ä»£ç è§„èŒƒ**: éµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒï¼Œæ³¨é‡Šè¯¦ç»†

## éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- âœ… å•†å“æ‰¹é‡ä¸Šä¸‹æ¶åŠŸèƒ½å®Œæ•´æ­£ç¡®
- âœ… ä»·æ ¼æ‰¹é‡è°ƒæ•´åŠŸèƒ½ç¨³å®šå¯ç”¨
- âœ… åº“å­˜æ‰¹é‡æ›´æ–°åŠŸèƒ½é«˜æ•ˆå¯é 
- âœ… ç”¨æˆ·é€šçŸ¥æ‰¹é‡å‘é€åŠŸèƒ½æ­£å¸¸
- âœ… ä»»åŠ¡ç›‘æ§å’Œç»Ÿè®¡åŠŸèƒ½å®Œå–„

### æ€§èƒ½éªŒæ”¶
- âœ… æ‰¹é‡æ“ä½œå¯åŠ¨å“åº”æ—¶é—´ < 1s
- âœ… å•ä¸ªæ‰¹é‡ä»»åŠ¡å¤„ç†é€Ÿåº¦ â‰¥ 1000æ¡/ç§’
- âœ… æ”¯æŒ1000+å¹¶å‘æ‰¹é‡ä»»åŠ¡æäº¤
- âœ… æ‰¹é‡æ“ä½œçŠ¶æ€æ›´æ–°å®æ—¶æ€§ < 500ms
- âœ… ç³»ç»Ÿå†…å­˜å’ŒCPUä½¿ç”¨ç‡åˆç†

### å®‰å…¨éªŒæ”¶
- âœ… æƒé™éªŒè¯ä¸¥æ ¼ï¼Œéæ³•æ“ä½œè¢«æ­£ç¡®æ‹¦æˆª
- âœ… æ‰¹é‡æ“ä½œæ•°é‡é™åˆ¶æœ‰æ•ˆ
- âœ… æ“ä½œå®¡è®¡æ—¥å¿—è®°å½•å®Œæ•´
- âœ… è¾“å…¥éªŒè¯ä¸¥æ ¼ï¼ŒSQLæ³¨å…¥é˜²æŠ¤æœ‰æ•ˆ
- âœ… ç³»ç»Ÿå¼‚å¸¸ä¿¡æ¯ä¸æ³„éœ²æ•æ„Ÿæ•°æ®

### å¯é æ€§éªŒæ”¶
- âœ… æ‰¹é‡æ“ä½œæˆåŠŸç‡ â‰¥ 99.5%
- âœ… ç³»ç»Ÿæ•…éšœæ¢å¤æ—¶é—´ < 5åˆ†é’Ÿ
- âœ… ä»»åŠ¡çŠ¶æ€ç®¡ç†å‡†ç¡®ï¼Œæ”¯æŒå¼‚å¸¸æ¢å¤
- âœ… æ•°æ®ä¸€è‡´æ€§ä¿éšœï¼Œæ— æ•°æ®ä¸¢å¤±
- âœ… ç³»ç»Ÿé«˜å¯ç”¨ï¼Œå•èŠ‚ç‚¹æ•…éšœä¸å½±å“æœåŠ¡

### å¯æ‰©å±•æ€§éªŒæ”¶
- âœ… æ”¯æŒæ–°å¢æ‰¹é‡æ“ä½œç±»å‹
- âœ… é…ç½®æ¨¡å—åŒ–ï¼Œæ”¯æŒçµæ´»è°ƒæ•´
- âœ… å¤„ç†å™¨æ’ä»¶åŒ–ï¼Œæ˜“äºæ‰©å±•
- âœ… ç›‘æ§æŒ‡æ ‡å¯å®šåˆ¶
- âœ… éƒ¨ç½²æ”¯æŒæ°´å¹³æ‰©å±•

---

**å®æ–½è¯´æ˜**: æ¯ä¸ªä»»åŠ¡å®Œæˆåï¼Œè¯·åœ¨tasks.mdä¸­æ›´æ–°ä»»åŠ¡çŠ¶æ€ï¼Œæ ‡è®°ä¸º[x]ã€‚æ³¨æ„ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»ï¼Œç¡®ä¿å‰ç½®ä»»åŠ¡è´¨é‡è¾¾æ ‡åå†å¼€å§‹åç»­ä»»åŠ¡ã€‚æ‰¹é‡æ“ä½œæ¶‰åŠå¤§é‡æ•°æ®ï¼Œè¯·ç¡®ä¿æ•°æ®å®‰å…¨å’Œæ€§èƒ½ä¼˜åŒ–åˆ°ä½ã€‚
