# 校园轻享集市系统 - 环境配置模板
# Author: BaSui 😎
# Description: 复制此文件为 .env 并修改配置
# 使用方法: cp .env.example .env

# ==================== 应用配置 ====================
APP_NAME=campus-marketplace
SPRING_PROFILES_ACTIVE=dev
SERVER_PORT=8200
APP_CONTEXT_PATH=/api
DOCKER_COMPOSE_FILE=docker/docker-compose.dev.yml

# ==================== PostgreSQL 配置 ====================
DB_HOST=localhost
DB_PORT=5432
DB_NAME=campus_marketplace_dev
DB_USERNAME=postgres
DB_PASSWORD=postgres
DB_POOL_MIN_IDLE=5
DB_POOL_MAX_SIZE=20
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=600000
DB_MAX_LIFETIME=1800000
DB_POOL_NAME=CampusMarketplaceHikariCP

# ==================== JPA 配置 ====================
JPA_DDL_AUTO=update
JPA_SHOW_SQL=true
JPA_FORMAT_SQL=true
JPA_ENABLE_LAZY_NO_TRANS=false
JPA_BATCH_SIZE=50
JPA_ORDER_INSERTS=true
JPA_ORDER_UPDATES=true
HIBERNATE_SECOND_LEVEL_CACHE=true
HIBERNATE_QUERY_CACHE=true

# ==================== Redis 配置 ====================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0
REDIS_POOL_MAX_ACTIVE=20
REDIS_POOL_MAX_IDLE=10
REDIS_POOL_MIN_IDLE=5
REDIS_SENTINEL_MASTER=
REDIS_SENTINEL_NODES=

# ==================== 邮件配置 ====================
MAIL_HOST=localhost
MAIL_PORT=1025
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_FROM_NAME=校园轻享集市
MAIL_SSL_ENABLE=false
MAIL_STARTTLS_ENABLE=false
# dev 日志伪发开关（true=仅日志不发信；生产请设为 false）
MAIL_MOCK_ENABLED=true

# ==================== 短信（阿里云）====================
SMS_PROVIDER=aliyun
ALIYUN_SMS_ACCESS_KEY_ID=
ALIYUN_SMS_ACCESS_KEY_SECRET=
ALIYUN_SMS_SIGN_NAME=
# 短信模板编码（请在阿里云短信控制台创建后填写）
ALIYUN_SMS_TEMPLATE_REGISTER=SMS_0000001
ALIYUN_SMS_TEMPLATE_RESET=SMS_0000002

# ==================== JWT 配置 ====================
# JWT密钥（生产环境必须修改！建议≥64字节，使用随机生成的强密钥）
# 生成方式: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET=5bwzFhN2dpPiac1wgPaFgb5iu_lEB5JrSxZqv-WIOwRiE_dQOE-fMFxy24-iOXgWm1NxybaJMrkbCXG9mY0a4Q
JWT_EXPIRATION=86400000
JWT_REFRESH_EXPIRATION=604800000

# ==================== AES 加密配置 ====================
# AES密钥（生产环境必须修改！建议≥32字节，支持AES-256）
# 生成方式: python -c "import secrets; print(secrets.token_urlsafe(32))"
AES_KEY=JrOagghJ4Ot3e63ObB1CJtOjvwYnk1chSwXR86E_MJs

# ==================== 验证码配置 ====================
VERIFICATION_CODE_LENGTH=6
VERIFICATION_CODE_EXPIRATION=600
VERIFICATION_RATE_LIMIT=60

# ==================== 2FA 配置 ====================
TWO_FACTOR_ENABLED=true
TWO_FACTOR_CODE_EXPIRATION=600

# ==================== 文件上传配置 ====================
FILE_UPLOAD_DIR=./uploads/dev
FILE_ALLOWED_EXTENSIONS=jpg,jpeg,png,gif
FILE_MAX_SIZE=5242880
FILE_MAX_REQUEST_SIZE=20971520
FILE_UPLOAD_ENABLED=true

# ==================== 支付宝配置（沙箱环境）====================
# 获取方式：https://open.alipay.com/develop/sandbox/app
ALIPAY_APP_ID=
ALIPAY_PRIVATE_KEY=
ALIPAY_PUBLIC_KEY=
ALIPAY_GATEWAY_URL=https://openapi-sandbox.dl.alipaydev.com/gateway.do
ALIPAY_NOTIFY_URL=http://localhost:8200/api/payment/alipay/notify
ALIPAY_RETURN_URL=http://localhost:3000/payment/result
ALIPAY_FORMAT=json
ALIPAY_SIGN_TYPE=RSA2
ALIPAY_CHARSET=UTF-8

# ==================== 微信支付配置 ====================
# 支持 V2 沙箱与 V3 正式双模式；默认启用 V3，需具备商户号后再联调
WECHAT_PAY_VERSION=v3

# ------ 微信支付 V2 （沙箱/开发）------
WECHAT_V2_APP_ID=
WECHAT_V2_MCH_ID=
WECHAT_V2_MCH_KEY=
WECHAT_V2_KEY_PATH=
WECHAT_V2_USE_SANDBOX=true
WECHAT_V2_NOTIFY_URL=http://localhost:8200/api/payment/wechat/notify

# ------ 微信支付 V3 （正式环境）------
WECHAT_APP_ID=wxa23d5ae949f8fd73
WECHAT_MCH_ID=
WECHAT_PRIVATE_KEY_PATH=
WECHAT_MERCHANT_SERIAL_NUMBER=
WECHAT_API_V3_KEY=
WECHAT_NOTIFY_URL=http://localhost:8200/api/payment/wechat/notify

# ==================== 佣金配置 ====================
COMMISSION_RATE=0.01
COMMISSION_MIN_RATE=0.005
COMMISSION_MAX_RATE=0.05

# ==================== 限流配置 ====================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_LIMIT=100
RATE_LIMIT_DEFAULT_PERIOD=60

# ==================== 日志配置 ====================
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=DEBUG
LOG_LEVEL_SQL=DEBUG
LOG_FILE_PATH=logs/campus-marketplace.log
LOG_FILE_MAX_SIZE=10MB
LOG_FILE_MAX_HISTORY=30
LOG_LEVEL_BINDER=TRACE
LOG_LEVEL_SPRING_SECURITY=DEBUG
LOG_PATTERN_CONSOLE="%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
LOG_PATTERN_FILE="%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
LOG_DIR=logs
LOG_FILE_BASENAME=campus-marketplace
LOGBACK_PATTERN=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50}:%line - %msg%n
LOGBACK_PATTERN_COLOR=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %highlight(%-5level) %cyan(%logger{50}):%line - %msg%n
SLOW_QUERY_LOG_MAX_HISTORY=7

# ==================== Actuator 配置 ====================
ACTUATOR_ENDPOINTS=*
ACTUATOR_HEALTH_SHOW_DETAILS=always
ACTUATOR_BASE_PATH=/actuator
ACTUATOR_EXCLUDE=shutdown
PROMETHEUS_ENABLED=true
METRICS_HTTP_HISTOGRAM=true
TRACING_PROBABILITY=1.0

# ==================== API 文档配置 ====================
SPRINGDOC_ENABLED=true
SWAGGER_UI_ENABLED=true

# ==================== 调试配置 ====================
DEBUG_ENABLED=true
DEBUG_SHOW_ERROR_DETAILS=true

# ==================== JWT 头部配置 ====================
JWT_HEADER=Authorization
JWT_PREFIX="Bearer "

# ==================== Tomcat 线程池 ====================
TOMCAT_MAX_THREADS=200
TOMCAT_MIN_SPARE_THREADS=10
