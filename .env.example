# ╔═══════════════════════════════════════════════════════════════════════╗
# ║  校园轻享集市系统 - 环境配置模板                                           ║
# ║  Campus Lite Marketplace - Environment Configuration Template         ║
# ╚═══════════════════════════════════════════════════════════════════════╝
#
# 📝 使用方法: cp .env.example .env 然后修改 .env 中的配置
# ⚠️ 重要: .env.example 提交到 git，.env 千万别提交（有密钥！）

# ==================== 应用基础配置 ====================
APP_NAME=campus-marketplace
SPRING_PROFILES_ACTIVE=dev
SERVER_PORT=8200
APP_CONTEXT_PATH=/api
DOCKER_COMPOSE_FILE=docker/docker-compose.yml

# ==================== PostgreSQL 数据库配置 ====================
DB_HOST=localhost
DB_PORT=5432
DB_NAME=campus_marketplace
DB_USERNAME=postgres
DB_PASSWORD=123456

# HikariCP 连接池配置
DB_POOL_MIN_IDLE=5
DB_POOL_MAX_SIZE=20
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=600000
DB_MAX_LIFETIME=1800000
DB_POOL_NAME=CampusMarketplaceHikariCP

# ==================== Flyway 数据库迁移配置 ====================
# 开发环境关闭 Flyway，使用 JPA 自动建表
# 生产环境建议启用 Flyway，使用迁移脚本管理数据库版本
FLYWAY_ENABLED=false

# ==================== JPA / Hibernate 配置 ====================
# DDL 策略: update(开发环境), validate(生产环境)
JPA_DDL_AUTO=update
JPA_SHOW_SQL=false
JPA_FORMAT_SQL=false
JPA_ENABLE_LAZY_NO_TRANS=false
JPA_BATCH_SIZE=50
JPA_ORDER_INSERTS=false
JPA_ORDER_UPDATES=false
HIBERNATE_SECOND_LEVEL_CACHE=true
HIBERNATE_QUERY_CACHE=true

# ==================== Redis 缓存配置 ====================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0

# Redis 连接池配置
REDIS_POOL_MAX_ACTIVE=20
REDIS_POOL_MAX_IDLE=10
REDIS_POOL_MIN_IDLE=5

# Redis 哨兵模式配置（高可用）
REDIS_SENTINEL_MASTER=
REDIS_SENTINEL_NODES=

# ==================== 邮件服务配置 ====================
MAIL_HOST=localhost
MAIL_PORT=1025
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_FROM_NAME=校园轻享集市
MAIL_SSL_ENABLE=false
MAIL_STARTTLS_ENABLE=false
MAIL_MOCK_ENABLED=true

# ==================== 短信服务配置(阿里云) ====================
SMS_PROVIDER=aliyun
ALIYUN_SMS_ACCESS_KEY_ID=
ALIYUN_SMS_ACCESS_KEY_SECRET=
ALIYUN_SMS_SIGN_NAME=
ALIYUN_SMS_TEMPLATE_REGISTER=SMS_0000001
ALIYUN_SMS_TEMPLATE_RESET=SMS_0000002

# ==================== JWT 认证配置 ====================
# JWT 密钥（建议生成随机字符串，至少64字符）
JWT_SECRET=5bwzFhN2dpPiac1wgPaFgb5iu_lEB5JrSxZqv-WIOwRiE_dQOE-fMFxy24-iOXgWm1NxybaJMrkbCXG9mY0a4Q

# Access Token 过期时间（毫秒）- 默认15分钟
JWT_EXPIRATION=900000

# Refresh Token 过期时间（毫秒）- 默认7天
JWT_REFRESH_EXPIRATION=604800000

# JWT 请求头配置
JWT_HEADER=Authorization
JWT_PREFIX="Bearer "

# ==================== AES 加密配置 ====================
AES_KEY=JrOagghJ4Ot3e63ObB1CJtOjvwYnk1chSwXR86E_MJs
BACKEND_ENCRYPT_KEY=JMMgf1RSDLBNksxUSNKl/2q94N6cIY7voJRXqlzcCBA=

# ==================== 验证码配置 ====================
VERIFICATION_CODE_LENGTH=6
VERIFICATION_CODE_EXPIRATION=600
VERIFICATION_RATE_LIMIT=60

# ==================== 双因素认证(2FA)配置 ====================
TWO_FACTOR_ENABLED=true
TWO_FACTOR_CODE_EXPIRATION=600

# ==================== 文件上传配置 ====================
FILE_UPLOAD_DIR=./uploads/dev
FILE_ALLOWED_EXTENSIONS=jpg,jpeg,png,gif
FILE_MAX_SIZE=5242880
FILE_MAX_REQUEST_SIZE=20971520
FILE_UPLOAD_ENABLED=true

# ==================== 支付宝支付配置 ====================
ALIPAY_APP_ID=
ALIPAY_PRIVATE_KEY=
ALIPAY_PUBLIC_KEY=
ALIPAY_GATEWAY_URL=https://openapi-sandbox.dl.alipaydev.com/gateway.do
ALIPAY_NOTIFY_URL=http://localhost:8200/api/payment/alipay/notify
ALIPAY_RETURN_URL=http://localhost:3000/payment/result
ALIPAY_FORMAT=json
ALIPAY_SIGN_TYPE=RSA2
ALIPAY_CHARSET=UTF-8

# ==================== 微信支付配置 ====================
WECHAT_PAY_VERSION=v3

# 微信支付 V2 配置（沙箱环境）
WECHAT_V2_APP_ID=
WECHAT_V2_MCH_ID=
WECHAT_V2_MCH_KEY=
WECHAT_V2_KEY_PATH=
WECHAT_V2_USE_SANDBOX=true
WECHAT_V2_NOTIFY_URL=http://localhost:8200/api/payment/wechat/notify

# 微信支付 V3 配置（正式环境）
WECHAT_APP_ID=wxa23d5ae949f8fd73
WECHAT_MCH_ID=
WECHAT_PRIVATE_KEY_PATH=
WECHAT_MERCHANT_SERIAL_NUMBER=
WECHAT_API_V3_KEY=
WECHAT_NOTIFY_URL=http://localhost:8200/api/payment/wechat/notify

# ==================== 佣金配置 ====================
COMMISSION_RATE=0.01
COMMISSION_MIN_RATE=0.005
COMMISSION_MAX_RATE=0.05

# ==================== 限流配置 ====================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_LIMIT=100
RATE_LIMIT_DEFAULT_PERIOD=60

# ==================== 日志配置 ====================
# 日志级别: TRACE → DEBUG → INFO → WARN → ERROR → FATAL
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=DEBUG
LOG_LEVEL_SQL=DEBUG
LOG_LEVEL_SPRING_SECURITY=DEBUG
LOG_LEVEL_BINDER=TRACE

# 日志文件配置
LOG_DIR=logs
LOG_FILE_BASENAME=campus-marketplace
LOG_FILE_PATH=logs/campus-marketplace.log
LOG_FILE_MAX_SIZE=10MB
LOG_FILE_MAX_HISTORY=30
SLOW_QUERY_LOG_MAX_HISTORY=7

# 日志格式配置
LOG_PATTERN_CONSOLE="%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
LOG_PATTERN_FILE="%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
LOGBACK_PATTERN=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50}:%line - %msg%n
LOGBACK_PATTERN_COLOR=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %highlight(%-5level) %cyan(%logger{50}):%line - %msg%n

# ==================== Spring Boot Actuator 监控配置 ====================
ACTUATOR_ENDPOINTS=*
ACTUATOR_HEALTH_SHOW_DETAILS=always
ACTUATOR_BASE_PATH=/actuator
ACTUATOR_EXCLUDE=shutdown
PROMETHEUS_ENABLED=true
METRICS_HTTP_HISTOGRAM=true
TRACING_PROBABILITY=1.0

# ==================== API 文档配置 ====================
SPRINGDOC_ENABLED=true
SWAGGER_UI_ENABLED=true

# ==================== 调试配置 ====================
DEBUG_ENABLED=true
DEBUG_SHOW_ERROR_DETAILS=true

# ==================== Tomcat 线程池配置 ====================
TOMCAT_MAX_THREADS=200
TOMCAT_MIN_SPARE_THREADS=10

# ==================== 静态资源配置 ====================
STATIC_RESOURCE_BASE_URL=http://localhost:8200
GOODS_IMAGE_UPLOAD_DIR=./uploads/goods
USER_AVATAR_UPLOAD_DIR=./uploads/avatars
IMAGE_ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,webp
IMAGE_MAX_SIZE=5242880
GOODS_MAX_IMAGES=9

# ==================== 前端配置(Vite 需要 VITE_ 前缀) ====================
VITE_API_BASE_URL=http://localhost:8200/api
VITE_WS_URL=ws://localhost:8200/ws
VITE_STATIC_BASE_URL=http://localhost:8200
VITE_APP_TITLE_ADMIN=校园轻享集市 - 管理端
VITE_APP_TITLE_PORTAL=校园轻享集市
VITE_APP_DESCRIPTION=校园二手交易与社区平台
VITE_ADMIN_PORT=8210
VITE_PORTAL_PORT=8220
VITE_ENCRYPT_KEY=JMMgf1RSDLBNksxUSNKl/2q94N6cIY7voJRXqlzcCBA=
